<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><link rel="canonical" href="https://rasmushaa.github.io/metrics-toolbox/autoapi/metrics_toolbox/evaluator/" />
      <link rel="shortcut icon" href="../../../img/favicon.ico" />
    <title>evaluator - Metrics Toolbox</title>
    <link rel="stylesheet" href="../../../css/theme.css" />
    <link rel="stylesheet" href="../../../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" />
        <link href="../../../assets/_mkdocstrings.css" rel="stylesheet" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "evaluator";
        var mkdocs_page_input_path = "autoapi/metrics_toolbox/evaluator.md";
        var mkdocs_page_url = "/metrics-toolbox/autoapi/metrics_toolbox/evaluator/";
      </script>
    
    <!--[if lt IE 9]>
      <script src="../../../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
      <script>hljs.highlightAll();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href="../../.." class="icon icon-home"> Metrics Toolbox
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../..">Home</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../../changes/">Changes</a>
                </li>
              </ul>
              <p class="caption"><span class="caption-text">API Reference</span></p>
              <ul class="current">
                  <li class="toctree-l1 current"><a class="reference internal current" href="../">metrics_toolbox</a>
    <ul class="current">
                <li class="toctree-l2"><a class="reference internal" href="../builder/">builder</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../encoding/">encoding</a>
                </li>
                <li class="toctree-l2 current"><a class="reference internal current" href="#">evaluator</a>
    <ul class="current">
    </ul>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../metrics/">metrics</a>
    <ul>
                <li class="toctree-l3"><a class="reference internal" href="../metrics/base_metric/">base_metric</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../metrics/classification/">classification</a>
    <ul>
                <li class="toctree-l4"><a class="reference internal" href="../metrics/classification/accuracy/">accuracy</a>
                </li>
                <li class="toctree-l4"><a class="reference internal" href="../metrics/classification/f1_score_macro/">f1_score_macro</a>
                </li>
                <li class="toctree-l4"><a class="reference internal" href="../metrics/classification/f1_score_micro/">f1_score_micro</a>
                </li>
                <li class="toctree-l4"><a class="reference internal" href="../metrics/classification/f1_score_target/">f1_score_target</a>
                </li>
                <li class="toctree-l4"><a class="reference internal" href="../metrics/classification/precision_macro/">precision_macro</a>
                </li>
                <li class="toctree-l4"><a class="reference internal" href="../metrics/classification/precision_micro/">precision_micro</a>
                </li>
                <li class="toctree-l4"><a class="reference internal" href="../metrics/classification/precision_target/">precision_target</a>
                </li>
                <li class="toctree-l4"><a class="reference internal" href="../metrics/classification/recall_macro/">recall_macro</a>
                </li>
                <li class="toctree-l4"><a class="reference internal" href="../metrics/classification/recall_micro/">recall_micro</a>
                </li>
                <li class="toctree-l4"><a class="reference internal" href="../metrics/classification/recall_target/">recall_target</a>
                </li>
    </ul>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../metrics/enums/">enums</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../metrics/probability/">probability</a>
    <ul>
                <li class="toctree-l4"><a class="reference internal" href="../metrics/probability/roc_auc_macro/">roc_auc_macro</a>
                </li>
                <li class="toctree-l4"><a class="reference internal" href="../metrics/probability/roc_auc_micro/">roc_auc_micro</a>
                </li>
                <li class="toctree-l4"><a class="reference internal" href="../metrics/probability/roc_auc_target/">roc_auc_target</a>
                </li>
    </ul>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../metrics/registry/">registry</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../metrics/regression/">regression</a>
    <ul>
                <li class="toctree-l4"><a class="reference internal" href="../metrics/regression/mse_macro/">mse_macro</a>
                </li>
                <li class="toctree-l4"><a class="reference internal" href="../metrics/regression/mse_target/">mse_target</a>
                </li>
                <li class="toctree-l4"><a class="reference internal" href="../metrics/regression/rmse_macro/">rmse_macro</a>
                </li>
                <li class="toctree-l4"><a class="reference internal" href="../metrics/regression/rmse_target/">rmse_target</a>
                </li>
    </ul>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../metrics/results/">results</a>
                </li>
    </ul>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../plots/">plots</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../reducers/">reducers</a>
    <ul>
                <li class="toctree-l3"><a class="reference internal" href="../reducers/reducers/">reducers</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../reducers/registry/">registry</a>
                </li>
    </ul>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../spec/">spec</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../utils/">utils</a>
                </li>
    </ul>
                  </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../..">Metrics Toolbox</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../../.." class="icon icon-home" aria-label="Docs"></a></li>
          <li class="breadcrumb-item">API Reference</li>
          <li class="breadcrumb-item"><a href="../">metrics_toolbox</a></li>
      <li class="breadcrumb-item active">evaluator</li>
    <li class="wy-breadcrumbs-aside">
          <a href="https://github.com/home/runner/work/metrics-toolbox/metrics-toolbox/metrics_toolbox/evaluator.py">Edit on rasmushaa/metrics-toolbox</a>
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <div class="doc doc-object doc-module">



<a id="metrics_toolbox.evaluator"></a>
    <div class="doc doc-contents first">










<div class="doc doc-children">









<div class="doc doc-object doc-class">



<h2 id="metrics_toolbox.evaluator.MetricEvaluator" class="doc doc-heading">
            <code>MetricEvaluator</code>


</h2>


    <div class="doc doc-contents ">



        <p>Evaluates and tracks metrics over multiple updates.</p>
<p>You can create a MetricEvaluator with a list of MetricSpecs, or use the
EvaluatorBuilder for a more convenient interface.</p>


<p><span class="doc-section-title">Methods:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="add_prob_evaluation(y_true, y_pred, column_names) (metrics_toolbox.evaluator.MetricEvaluator.add_prob_evaluation)" href="#metrics_toolbox.evaluator.MetricEvaluator.add_prob_evaluation">add_prob_evaluation</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>Evaluate PROB metrics and add new step to history.</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="add_label_evaluation(y_true, y_pred, column_names) (metrics_toolbox.evaluator.MetricEvaluator.add_label_evaluation)" href="#metrics_toolbox.evaluator.MetricEvaluator.add_label_evaluation">add_label_evaluation</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>Evaluate LABEL metrics and add new step to history.</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="add_model_evaluation(model, X, y_true, column_names=None) (metrics_toolbox.evaluator.MetricEvaluator.add_model_evaluation)" href="#metrics_toolbox.evaluator.MetricEvaluator.add_model_evaluation">add_model_evaluation</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>Evaluate a model and all included metrics. This method assumes the model has
predict() and predict_proba() methods.</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="get_results() (metrics_toolbox.evaluator.MetricEvaluator.get_results)" href="#metrics_toolbox.evaluator.MetricEvaluator.get_results">get_results</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>Get evaluation results including reduced values, full history, and plots.</p>
                </div>
              </td>
            </tr>
      </tbody>
    </table>







              <details class="quote">
                <summary>Source code in <code>metrics_toolbox/evaluator.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-24"> 24</a></span>
<span class="normal"><a href="#__codelineno-0-25"> 25</a></span>
<span class="normal"><a href="#__codelineno-0-26"> 26</a></span>
<span class="normal"><a href="#__codelineno-0-27"> 27</a></span>
<span class="normal"><a href="#__codelineno-0-28"> 28</a></span>
<span class="normal"><a href="#__codelineno-0-29"> 29</a></span>
<span class="normal"><a href="#__codelineno-0-30"> 30</a></span>
<span class="normal"><a href="#__codelineno-0-31"> 31</a></span>
<span class="normal"><a href="#__codelineno-0-32"> 32</a></span>
<span class="normal"><a href="#__codelineno-0-33"> 33</a></span>
<span class="normal"><a href="#__codelineno-0-34"> 34</a></span>
<span class="normal"><a href="#__codelineno-0-35"> 35</a></span>
<span class="normal"><a href="#__codelineno-0-36"> 36</a></span>
<span class="normal"><a href="#__codelineno-0-37"> 37</a></span>
<span class="normal"><a href="#__codelineno-0-38"> 38</a></span>
<span class="normal"><a href="#__codelineno-0-39"> 39</a></span>
<span class="normal"><a href="#__codelineno-0-40"> 40</a></span>
<span class="normal"><a href="#__codelineno-0-41"> 41</a></span>
<span class="normal"><a href="#__codelineno-0-42"> 42</a></span>
<span class="normal"><a href="#__codelineno-0-43"> 43</a></span>
<span class="normal"><a href="#__codelineno-0-44"> 44</a></span>
<span class="normal"><a href="#__codelineno-0-45"> 45</a></span>
<span class="normal"><a href="#__codelineno-0-46"> 46</a></span>
<span class="normal"><a href="#__codelineno-0-47"> 47</a></span>
<span class="normal"><a href="#__codelineno-0-48"> 48</a></span>
<span class="normal"><a href="#__codelineno-0-49"> 49</a></span>
<span class="normal"><a href="#__codelineno-0-50"> 50</a></span>
<span class="normal"><a href="#__codelineno-0-51"> 51</a></span>
<span class="normal"><a href="#__codelineno-0-52"> 52</a></span>
<span class="normal"><a href="#__codelineno-0-53"> 53</a></span>
<span class="normal"><a href="#__codelineno-0-54"> 54</a></span>
<span class="normal"><a href="#__codelineno-0-55"> 55</a></span>
<span class="normal"><a href="#__codelineno-0-56"> 56</a></span>
<span class="normal"><a href="#__codelineno-0-57"> 57</a></span>
<span class="normal"><a href="#__codelineno-0-58"> 58</a></span>
<span class="normal"><a href="#__codelineno-0-59"> 59</a></span>
<span class="normal"><a href="#__codelineno-0-60"> 60</a></span>
<span class="normal"><a href="#__codelineno-0-61"> 61</a></span>
<span class="normal"><a href="#__codelineno-0-62"> 62</a></span>
<span class="normal"><a href="#__codelineno-0-63"> 63</a></span>
<span class="normal"><a href="#__codelineno-0-64"> 64</a></span>
<span class="normal"><a href="#__codelineno-0-65"> 65</a></span>
<span class="normal"><a href="#__codelineno-0-66"> 66</a></span>
<span class="normal"><a href="#__codelineno-0-67"> 67</a></span>
<span class="normal"><a href="#__codelineno-0-68"> 68</a></span>
<span class="normal"><a href="#__codelineno-0-69"> 69</a></span>
<span class="normal"><a href="#__codelineno-0-70"> 70</a></span>
<span class="normal"><a href="#__codelineno-0-71"> 71</a></span>
<span class="normal"><a href="#__codelineno-0-72"> 72</a></span>
<span class="normal"><a href="#__codelineno-0-73"> 73</a></span>
<span class="normal"><a href="#__codelineno-0-74"> 74</a></span>
<span class="normal"><a href="#__codelineno-0-75"> 75</a></span>
<span class="normal"><a href="#__codelineno-0-76"> 76</a></span>
<span class="normal"><a href="#__codelineno-0-77"> 77</a></span>
<span class="normal"><a href="#__codelineno-0-78"> 78</a></span>
<span class="normal"><a href="#__codelineno-0-79"> 79</a></span>
<span class="normal"><a href="#__codelineno-0-80"> 80</a></span>
<span class="normal"><a href="#__codelineno-0-81"> 81</a></span>
<span class="normal"><a href="#__codelineno-0-82"> 82</a></span>
<span class="normal"><a href="#__codelineno-0-83"> 83</a></span>
<span class="normal"><a href="#__codelineno-0-84"> 84</a></span>
<span class="normal"><a href="#__codelineno-0-85"> 85</a></span>
<span class="normal"><a href="#__codelineno-0-86"> 86</a></span>
<span class="normal"><a href="#__codelineno-0-87"> 87</a></span>
<span class="normal"><a href="#__codelineno-0-88"> 88</a></span>
<span class="normal"><a href="#__codelineno-0-89"> 89</a></span>
<span class="normal"><a href="#__codelineno-0-90"> 90</a></span>
<span class="normal"><a href="#__codelineno-0-91"> 91</a></span>
<span class="normal"><a href="#__codelineno-0-92"> 92</a></span>
<span class="normal"><a href="#__codelineno-0-93"> 93</a></span>
<span class="normal"><a href="#__codelineno-0-94"> 94</a></span>
<span class="normal"><a href="#__codelineno-0-95"> 95</a></span>
<span class="normal"><a href="#__codelineno-0-96"> 96</a></span>
<span class="normal"><a href="#__codelineno-0-97"> 97</a></span>
<span class="normal"><a href="#__codelineno-0-98"> 98</a></span>
<span class="normal"><a href="#__codelineno-0-99"> 99</a></span>
<span class="normal"><a href="#__codelineno-0-100">100</a></span>
<span class="normal"><a href="#__codelineno-0-101">101</a></span>
<span class="normal"><a href="#__codelineno-0-102">102</a></span>
<span class="normal"><a href="#__codelineno-0-103">103</a></span>
<span class="normal"><a href="#__codelineno-0-104">104</a></span>
<span class="normal"><a href="#__codelineno-0-105">105</a></span>
<span class="normal"><a href="#__codelineno-0-106">106</a></span>
<span class="normal"><a href="#__codelineno-0-107">107</a></span>
<span class="normal"><a href="#__codelineno-0-108">108</a></span>
<span class="normal"><a href="#__codelineno-0-109">109</a></span>
<span class="normal"><a href="#__codelineno-0-110">110</a></span>
<span class="normal"><a href="#__codelineno-0-111">111</a></span>
<span class="normal"><a href="#__codelineno-0-112">112</a></span>
<span class="normal"><a href="#__codelineno-0-113">113</a></span>
<span class="normal"><a href="#__codelineno-0-114">114</a></span>
<span class="normal"><a href="#__codelineno-0-115">115</a></span>
<span class="normal"><a href="#__codelineno-0-116">116</a></span>
<span class="normal"><a href="#__codelineno-0-117">117</a></span>
<span class="normal"><a href="#__codelineno-0-118">118</a></span>
<span class="normal"><a href="#__codelineno-0-119">119</a></span>
<span class="normal"><a href="#__codelineno-0-120">120</a></span>
<span class="normal"><a href="#__codelineno-0-121">121</a></span>
<span class="normal"><a href="#__codelineno-0-122">122</a></span>
<span class="normal"><a href="#__codelineno-0-123">123</a></span>
<span class="normal"><a href="#__codelineno-0-124">124</a></span>
<span class="normal"><a href="#__codelineno-0-125">125</a></span>
<span class="normal"><a href="#__codelineno-0-126">126</a></span>
<span class="normal"><a href="#__codelineno-0-127">127</a></span>
<span class="normal"><a href="#__codelineno-0-128">128</a></span>
<span class="normal"><a href="#__codelineno-0-129">129</a></span>
<span class="normal"><a href="#__codelineno-0-130">130</a></span>
<span class="normal"><a href="#__codelineno-0-131">131</a></span>
<span class="normal"><a href="#__codelineno-0-132">132</a></span>
<span class="normal"><a href="#__codelineno-0-133">133</a></span>
<span class="normal"><a href="#__codelineno-0-134">134</a></span>
<span class="normal"><a href="#__codelineno-0-135">135</a></span>
<span class="normal"><a href="#__codelineno-0-136">136</a></span>
<span class="normal"><a href="#__codelineno-0-137">137</a></span>
<span class="normal"><a href="#__codelineno-0-138">138</a></span>
<span class="normal"><a href="#__codelineno-0-139">139</a></span>
<span class="normal"><a href="#__codelineno-0-140">140</a></span>
<span class="normal"><a href="#__codelineno-0-141">141</a></span>
<span class="normal"><a href="#__codelineno-0-142">142</a></span>
<span class="normal"><a href="#__codelineno-0-143">143</a></span>
<span class="normal"><a href="#__codelineno-0-144">144</a></span>
<span class="normal"><a href="#__codelineno-0-145">145</a></span>
<span class="normal"><a href="#__codelineno-0-146">146</a></span>
<span class="normal"><a href="#__codelineno-0-147">147</a></span>
<span class="normal"><a href="#__codelineno-0-148">148</a></span>
<span class="normal"><a href="#__codelineno-0-149">149</a></span>
<span class="normal"><a href="#__codelineno-0-150">150</a></span>
<span class="normal"><a href="#__codelineno-0-151">151</a></span>
<span class="normal"><a href="#__codelineno-0-152">152</a></span>
<span class="normal"><a href="#__codelineno-0-153">153</a></span>
<span class="normal"><a href="#__codelineno-0-154">154</a></span>
<span class="normal"><a href="#__codelineno-0-155">155</a></span>
<span class="normal"><a href="#__codelineno-0-156">156</a></span>
<span class="normal"><a href="#__codelineno-0-157">157</a></span>
<span class="normal"><a href="#__codelineno-0-158">158</a></span>
<span class="normal"><a href="#__codelineno-0-159">159</a></span>
<span class="normal"><a href="#__codelineno-0-160">160</a></span>
<span class="normal"><a href="#__codelineno-0-161">161</a></span>
<span class="normal"><a href="#__codelineno-0-162">162</a></span>
<span class="normal"><a href="#__codelineno-0-163">163</a></span>
<span class="normal"><a href="#__codelineno-0-164">164</a></span>
<span class="normal"><a href="#__codelineno-0-165">165</a></span>
<span class="normal"><a href="#__codelineno-0-166">166</a></span>
<span class="normal"><a href="#__codelineno-0-167">167</a></span>
<span class="normal"><a href="#__codelineno-0-168">168</a></span>
<span class="normal"><a href="#__codelineno-0-169">169</a></span>
<span class="normal"><a href="#__codelineno-0-170">170</a></span>
<span class="normal"><a href="#__codelineno-0-171">171</a></span>
<span class="normal"><a href="#__codelineno-0-172">172</a></span>
<span class="normal"><a href="#__codelineno-0-173">173</a></span>
<span class="normal"><a href="#__codelineno-0-174">174</a></span>
<span class="normal"><a href="#__codelineno-0-175">175</a></span>
<span class="normal"><a href="#__codelineno-0-176">176</a></span>
<span class="normal"><a href="#__codelineno-0-177">177</a></span>
<span class="normal"><a href="#__codelineno-0-178">178</a></span>
<span class="normal"><a href="#__codelineno-0-179">179</a></span>
<span class="normal"><a href="#__codelineno-0-180">180</a></span>
<span class="normal"><a href="#__codelineno-0-181">181</a></span>
<span class="normal"><a href="#__codelineno-0-182">182</a></span>
<span class="normal"><a href="#__codelineno-0-183">183</a></span>
<span class="normal"><a href="#__codelineno-0-184">184</a></span>
<span class="normal"><a href="#__codelineno-0-185">185</a></span>
<span class="normal"><a href="#__codelineno-0-186">186</a></span>
<span class="normal"><a href="#__codelineno-0-187">187</a></span>
<span class="normal"><a href="#__codelineno-0-188">188</a></span>
<span class="normal"><a href="#__codelineno-0-189">189</a></span>
<span class="normal"><a href="#__codelineno-0-190">190</a></span>
<span class="normal"><a href="#__codelineno-0-191">191</a></span>
<span class="normal"><a href="#__codelineno-0-192">192</a></span>
<span class="normal"><a href="#__codelineno-0-193">193</a></span>
<span class="normal"><a href="#__codelineno-0-194">194</a></span>
<span class="normal"><a href="#__codelineno-0-195">195</a></span>
<span class="normal"><a href="#__codelineno-0-196">196</a></span>
<span class="normal"><a href="#__codelineno-0-197">197</a></span>
<span class="normal"><a href="#__codelineno-0-198">198</a></span>
<span class="normal"><a href="#__codelineno-0-199">199</a></span>
<span class="normal"><a href="#__codelineno-0-200">200</a></span>
<span class="normal"><a href="#__codelineno-0-201">201</a></span>
<span class="normal"><a href="#__codelineno-0-202">202</a></span>
<span class="normal"><a href="#__codelineno-0-203">203</a></span>
<span class="normal"><a href="#__codelineno-0-204">204</a></span>
<span class="normal"><a href="#__codelineno-0-205">205</a></span>
<span class="normal"><a href="#__codelineno-0-206">206</a></span>
<span class="normal"><a href="#__codelineno-0-207">207</a></span>
<span class="normal"><a href="#__codelineno-0-208">208</a></span>
<span class="normal"><a href="#__codelineno-0-209">209</a></span>
<span class="normal"><a href="#__codelineno-0-210">210</a></span>
<span class="normal"><a href="#__codelineno-0-211">211</a></span>
<span class="normal"><a href="#__codelineno-0-212">212</a></span>
<span class="normal"><a href="#__codelineno-0-213">213</a></span>
<span class="normal"><a href="#__codelineno-0-214">214</a></span>
<span class="normal"><a href="#__codelineno-0-215">215</a></span>
<span class="normal"><a href="#__codelineno-0-216">216</a></span>
<span class="normal"><a href="#__codelineno-0-217">217</a></span>
<span class="normal"><a href="#__codelineno-0-218">218</a></span>
<span class="normal"><a href="#__codelineno-0-219">219</a></span>
<span class="normal"><a href="#__codelineno-0-220">220</a></span>
<span class="normal"><a href="#__codelineno-0-221">221</a></span>
<span class="normal"><a href="#__codelineno-0-222">222</a></span>
<span class="normal"><a href="#__codelineno-0-223">223</a></span>
<span class="normal"><a href="#__codelineno-0-224">224</a></span>
<span class="normal"><a href="#__codelineno-0-225">225</a></span>
<span class="normal"><a href="#__codelineno-0-226">226</a></span>
<span class="normal"><a href="#__codelineno-0-227">227</a></span>
<span class="normal"><a href="#__codelineno-0-228">228</a></span>
<span class="normal"><a href="#__codelineno-0-229">229</a></span>
<span class="normal"><a href="#__codelineno-0-230">230</a></span>
<span class="normal"><a href="#__codelineno-0-231">231</a></span>
<span class="normal"><a href="#__codelineno-0-232">232</a></span>
<span class="normal"><a href="#__codelineno-0-233">233</a></span>
<span class="normal"><a href="#__codelineno-0-234">234</a></span>
<span class="normal"><a href="#__codelineno-0-235">235</a></span>
<span class="normal"><a href="#__codelineno-0-236">236</a></span>
<span class="normal"><a href="#__codelineno-0-237">237</a></span>
<span class="normal"><a href="#__codelineno-0-238">238</a></span>
<span class="normal"><a href="#__codelineno-0-239">239</a></span>
<span class="normal"><a href="#__codelineno-0-240">240</a></span>
<span class="normal"><a href="#__codelineno-0-241">241</a></span>
<span class="normal"><a href="#__codelineno-0-242">242</a></span>
<span class="normal"><a href="#__codelineno-0-243">243</a></span>
<span class="normal"><a href="#__codelineno-0-244">244</a></span>
<span class="normal"><a href="#__codelineno-0-245">245</a></span>
<span class="normal"><a href="#__codelineno-0-246">246</a></span>
<span class="normal"><a href="#__codelineno-0-247">247</a></span>
<span class="normal"><a href="#__codelineno-0-248">248</a></span>
<span class="normal"><a href="#__codelineno-0-249">249</a></span>
<span class="normal"><a href="#__codelineno-0-250">250</a></span>
<span class="normal"><a href="#__codelineno-0-251">251</a></span>
<span class="normal"><a href="#__codelineno-0-252">252</a></span>
<span class="normal"><a href="#__codelineno-0-253">253</a></span>
<span class="normal"><a href="#__codelineno-0-254">254</a></span>
<span class="normal"><a href="#__codelineno-0-255">255</a></span>
<span class="normal"><a href="#__codelineno-0-256">256</a></span>
<span class="normal"><a href="#__codelineno-0-257">257</a></span>
<span class="normal"><a href="#__codelineno-0-258">258</a></span>
<span class="normal"><a href="#__codelineno-0-259">259</a></span>
<span class="normal"><a href="#__codelineno-0-260">260</a></span>
<span class="normal"><a href="#__codelineno-0-261">261</a></span>
<span class="normal"><a href="#__codelineno-0-262">262</a></span>
<span class="normal"><a href="#__codelineno-0-263">263</a></span>
<span class="normal"><a href="#__codelineno-0-264">264</a></span>
<span class="normal"><a href="#__codelineno-0-265">265</a></span>
<span class="normal"><a href="#__codelineno-0-266">266</a></span>
<span class="normal"><a href="#__codelineno-0-267">267</a></span>
<span class="normal"><a href="#__codelineno-0-268">268</a></span>
<span class="normal"><a href="#__codelineno-0-269">269</a></span>
<span class="normal"><a href="#__codelineno-0-270">270</a></span>
<span class="normal"><a href="#__codelineno-0-271">271</a></span>
<span class="normal"><a href="#__codelineno-0-272">272</a></span>
<span class="normal"><a href="#__codelineno-0-273">273</a></span>
<span class="normal"><a href="#__codelineno-0-274">274</a></span>
<span class="normal"><a href="#__codelineno-0-275">275</a></span>
<span class="normal"><a href="#__codelineno-0-276">276</a></span>
<span class="normal"><a href="#__codelineno-0-277">277</a></span>
<span class="normal"><a href="#__codelineno-0-278">278</a></span>
<span class="normal"><a href="#__codelineno-0-279">279</a></span>
<span class="normal"><a href="#__codelineno-0-280">280</a></span>
<span class="normal"><a href="#__codelineno-0-281">281</a></span>
<span class="normal"><a href="#__codelineno-0-282">282</a></span>
<span class="normal"><a href="#__codelineno-0-283">283</a></span>
<span class="normal"><a href="#__codelineno-0-284">284</a></span>
<span class="normal"><a href="#__codelineno-0-285">285</a></span>
<span class="normal"><a href="#__codelineno-0-286">286</a></span>
<span class="normal"><a href="#__codelineno-0-287">287</a></span>
<span class="normal"><a href="#__codelineno-0-288">288</a></span>
<span class="normal"><a href="#__codelineno-0-289">289</a></span>
<span class="normal"><a href="#__codelineno-0-290">290</a></span>
<span class="normal"><a href="#__codelineno-0-291">291</a></span>
<span class="normal"><a href="#__codelineno-0-292">292</a></span>
<span class="normal"><a href="#__codelineno-0-293">293</a></span>
<span class="normal"><a href="#__codelineno-0-294">294</a></span>
<span class="normal"><a href="#__codelineno-0-295">295</a></span>
<span class="normal"><a href="#__codelineno-0-296">296</a></span>
<span class="normal"><a href="#__codelineno-0-297">297</a></span>
<span class="normal"><a href="#__codelineno-0-298">298</a></span>
<span class="normal"><a href="#__codelineno-0-299">299</a></span>
<span class="normal"><a href="#__codelineno-0-300">300</a></span>
<span class="normal"><a href="#__codelineno-0-301">301</a></span>
<span class="normal"><a href="#__codelineno-0-302">302</a></span>
<span class="normal"><a href="#__codelineno-0-303">303</a></span>
<span class="normal"><a href="#__codelineno-0-304">304</a></span>
<span class="normal"><a href="#__codelineno-0-305">305</a></span>
<span class="normal"><a href="#__codelineno-0-306">306</a></span>
<span class="normal"><a href="#__codelineno-0-307">307</a></span>
<span class="normal"><a href="#__codelineno-0-308">308</a></span>
<span class="normal"><a href="#__codelineno-0-309">309</a></span>
<span class="normal"><a href="#__codelineno-0-310">310</a></span>
<span class="normal"><a href="#__codelineno-0-311">311</a></span>
<span class="normal"><a href="#__codelineno-0-312">312</a></span>
<span class="normal"><a href="#__codelineno-0-313">313</a></span>
<span class="normal"><a href="#__codelineno-0-314">314</a></span>
<span class="normal"><a href="#__codelineno-0-315">315</a></span>
<span class="normal"><a href="#__codelineno-0-316">316</a></span>
<span class="normal"><a href="#__codelineno-0-317">317</a></span>
<span class="normal"><a href="#__codelineno-0-318">318</a></span>
<span class="normal"><a href="#__codelineno-0-319">319</a></span>
<span class="normal"><a href="#__codelineno-0-320">320</a></span>
<span class="normal"><a href="#__codelineno-0-321">321</a></span>
<span class="normal"><a href="#__codelineno-0-322">322</a></span>
<span class="normal"><a href="#__codelineno-0-323">323</a></span>
<span class="normal"><a href="#__codelineno-0-324">324</a></span>
<span class="normal"><a href="#__codelineno-0-325">325</a></span>
<span class="normal"><a href="#__codelineno-0-326">326</a></span>
<span class="normal"><a href="#__codelineno-0-327">327</a></span>
<span class="normal"><a href="#__codelineno-0-328">328</a></span>
<span class="normal"><a href="#__codelineno-0-329">329</a></span>
<span class="normal"><a href="#__codelineno-0-330">330</a></span>
<span class="normal"><a href="#__codelineno-0-331">331</a></span>
<span class="normal"><a href="#__codelineno-0-332">332</a></span>
<span class="normal"><a href="#__codelineno-0-333">333</a></span>
<span class="normal"><a href="#__codelineno-0-334">334</a></span>
<span class="normal"><a href="#__codelineno-0-335">335</a></span>
<span class="normal"><a href="#__codelineno-0-336">336</a></span>
<span class="normal"><a href="#__codelineno-0-337">337</a></span>
<span class="normal"><a href="#__codelineno-0-338">338</a></span>
<span class="normal"><a href="#__codelineno-0-339">339</a></span>
<span class="normal"><a href="#__codelineno-0-340">340</a></span>
<span class="normal"><a href="#__codelineno-0-341">341</a></span>
<span class="normal"><a href="#__codelineno-0-342">342</a></span>
<span class="normal"><a href="#__codelineno-0-343">343</a></span>
<span class="normal"><a href="#__codelineno-0-344">344</a></span>
<span class="normal"><a href="#__codelineno-0-345">345</a></span>
<span class="normal"><a href="#__codelineno-0-346">346</a></span>
<span class="normal"><a href="#__codelineno-0-347">347</a></span>
<span class="normal"><a href="#__codelineno-0-348">348</a></span>
<span class="normal"><a href="#__codelineno-0-349">349</a></span>
<span class="normal"><a href="#__codelineno-0-350">350</a></span>
<span class="normal"><a href="#__codelineno-0-351">351</a></span>
<span class="normal"><a href="#__codelineno-0-352">352</a></span>
<span class="normal"><a href="#__codelineno-0-353">353</a></span>
<span class="normal"><a href="#__codelineno-0-354">354</a></span>
<span class="normal"><a href="#__codelineno-0-355">355</a></span>
<span class="normal"><a href="#__codelineno-0-356">356</a></span>
<span class="normal"><a href="#__codelineno-0-357">357</a></span>
<span class="normal"><a href="#__codelineno-0-358">358</a></span>
<span class="normal"><a href="#__codelineno-0-359">359</a></span>
<span class="normal"><a href="#__codelineno-0-360">360</a></span>
<span class="normal"><a href="#__codelineno-0-361">361</a></span>
<span class="normal"><a href="#__codelineno-0-362">362</a></span>
<span class="normal"><a href="#__codelineno-0-363">363</a></span>
<span class="normal"><a href="#__codelineno-0-364">364</a></span>
<span class="normal"><a href="#__codelineno-0-365">365</a></span>
<span class="normal"><a href="#__codelineno-0-366">366</a></span>
<span class="normal"><a href="#__codelineno-0-367">367</a></span>
<span class="normal"><a href="#__codelineno-0-368">368</a></span>
<span class="normal"><a href="#__codelineno-0-369">369</a></span>
<span class="normal"><a href="#__codelineno-0-370">370</a></span>
<span class="normal"><a href="#__codelineno-0-371">371</a></span>
<span class="normal"><a href="#__codelineno-0-372">372</a></span>
<span class="normal"><a href="#__codelineno-0-373">373</a></span>
<span class="normal"><a href="#__codelineno-0-374">374</a></span>
<span class="normal"><a href="#__codelineno-0-375">375</a></span>
<span class="normal"><a href="#__codelineno-0-376">376</a></span>
<span class="normal"><a href="#__codelineno-0-377">377</a></span>
<span class="normal"><a href="#__codelineno-0-378">378</a></span>
<span class="normal"><a href="#__codelineno-0-379">379</a></span>
<span class="normal"><a href="#__codelineno-0-380">380</a></span>
<span class="normal"><a href="#__codelineno-0-381">381</a></span>
<span class="normal"><a href="#__codelineno-0-382">382</a></span>
<span class="normal"><a href="#__codelineno-0-383">383</a></span>
<span class="normal"><a href="#__codelineno-0-384">384</a></span>
<span class="normal"><a href="#__codelineno-0-385">385</a></span>
<span class="normal"><a href="#__codelineno-0-386">386</a></span>
<span class="normal"><a href="#__codelineno-0-387">387</a></span>
<span class="normal"><a href="#__codelineno-0-388">388</a></span>
<span class="normal"><a href="#__codelineno-0-389">389</a></span>
<span class="normal"><a href="#__codelineno-0-390">390</a></span>
<span class="normal"><a href="#__codelineno-0-391">391</a></span>
<span class="normal"><a href="#__codelineno-0-392">392</a></span>
<span class="normal"><a href="#__codelineno-0-393">393</a></span>
<span class="normal"><a href="#__codelineno-0-394">394</a></span>
<span class="normal"><a href="#__codelineno-0-395">395</a></span>
<span class="normal"><a href="#__codelineno-0-396">396</a></span>
<span class="normal"><a href="#__codelineno-0-397">397</a></span>
<span class="normal"><a href="#__codelineno-0-398">398</a></span>
<span class="normal"><a href="#__codelineno-0-399">399</a></span>
<span class="normal"><a href="#__codelineno-0-400">400</a></span>
<span class="normal"><a href="#__codelineno-0-401">401</a></span>
<span class="normal"><a href="#__codelineno-0-402">402</a></span>
<span class="normal"><a href="#__codelineno-0-403">403</a></span>
<span class="normal"><a href="#__codelineno-0-404">404</a></span>
<span class="normal"><a href="#__codelineno-0-405">405</a></span>
<span class="normal"><a href="#__codelineno-0-406">406</a></span>
<span class="normal"><a href="#__codelineno-0-407">407</a></span>
<span class="normal"><a href="#__codelineno-0-408">408</a></span>
<span class="normal"><a href="#__codelineno-0-409">409</a></span>
<span class="normal"><a href="#__codelineno-0-410">410</a></span>
<span class="normal"><a href="#__codelineno-0-411">411</a></span>
<span class="normal"><a href="#__codelineno-0-412">412</a></span>
<span class="normal"><a href="#__codelineno-0-413">413</a></span>
<span class="normal"><a href="#__codelineno-0-414">414</a></span>
<span class="normal"><a href="#__codelineno-0-415">415</a></span>
<span class="normal"><a href="#__codelineno-0-416">416</a></span>
<span class="normal"><a href="#__codelineno-0-417">417</a></span>
<span class="normal"><a href="#__codelineno-0-418">418</a></span>
<span class="normal"><a href="#__codelineno-0-419">419</a></span>
<span class="normal"><a href="#__codelineno-0-420">420</a></span>
<span class="normal"><a href="#__codelineno-0-421">421</a></span>
<span class="normal"><a href="#__codelineno-0-422">422</a></span>
<span class="normal"><a href="#__codelineno-0-423">423</a></span>
<span class="normal"><a href="#__codelineno-0-424">424</a></span>
<span class="normal"><a href="#__codelineno-0-425">425</a></span>
<span class="normal"><a href="#__codelineno-0-426">426</a></span>
<span class="normal"><a href="#__codelineno-0-427">427</a></span>
<span class="normal"><a href="#__codelineno-0-428">428</a></span>
<span class="normal"><a href="#__codelineno-0-429">429</a></span>
<span class="normal"><a href="#__codelineno-0-430">430</a></span>
<span class="normal"><a href="#__codelineno-0-431">431</a></span>
<span class="normal"><a href="#__codelineno-0-432">432</a></span>
<span class="normal"><a href="#__codelineno-0-433">433</a></span>
<span class="normal"><a href="#__codelineno-0-434">434</a></span>
<span class="normal"><a href="#__codelineno-0-435">435</a></span>
<span class="normal"><a href="#__codelineno-0-436">436</a></span>
<span class="normal"><a href="#__codelineno-0-437">437</a></span>
<span class="normal"><a href="#__codelineno-0-438">438</a></span>
<span class="normal"><a href="#__codelineno-0-439">439</a></span>
<span class="normal"><a href="#__codelineno-0-440">440</a></span>
<span class="normal"><a href="#__codelineno-0-441">441</a></span>
<span class="normal"><a href="#__codelineno-0-442">442</a></span>
<span class="normal"><a href="#__codelineno-0-443">443</a></span>
<span class="normal"><a href="#__codelineno-0-444">444</a></span>
<span class="normal"><a href="#__codelineno-0-445">445</a></span>
<span class="normal"><a href="#__codelineno-0-446">446</a></span>
<span class="normal"><a href="#__codelineno-0-447">447</a></span>
<span class="normal"><a href="#__codelineno-0-448">448</a></span>
<span class="normal"><a href="#__codelineno-0-449">449</a></span>
<span class="normal"><a href="#__codelineno-0-450">450</a></span>
<span class="normal"><a href="#__codelineno-0-451">451</a></span>
<span class="normal"><a href="#__codelineno-0-452">452</a></span>
<span class="normal"><a href="#__codelineno-0-453">453</a></span>
<span class="normal"><a href="#__codelineno-0-454">454</a></span>
<span class="normal"><a href="#__codelineno-0-455">455</a></span>
<span class="normal"><a href="#__codelineno-0-456">456</a></span>
<span class="normal"><a href="#__codelineno-0-457">457</a></span>
<span class="normal"><a href="#__codelineno-0-458">458</a></span>
<span class="normal"><a href="#__codelineno-0-459">459</a></span>
<span class="normal"><a href="#__codelineno-0-460">460</a></span>
<span class="normal"><a href="#__codelineno-0-461">461</a></span>
<span class="normal"><a href="#__codelineno-0-462">462</a></span>
<span class="normal"><a href="#__codelineno-0-463">463</a></span>
<span class="normal"><a href="#__codelineno-0-464">464</a></span>
<span class="normal"><a href="#__codelineno-0-465">465</a></span>
<span class="normal"><a href="#__codelineno-0-466">466</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-24" name="__codelineno-0-24"></a><span class="k">class</span><span class="w"> </span><span class="nc">MetricEvaluator</span><span class="p">:</span>
<a id="__codelineno-0-25" name="__codelineno-0-25"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Evaluates and tracks metrics over multiple updates.</span>
<a id="__codelineno-0-26" name="__codelineno-0-26"></a>
<a id="__codelineno-0-27" name="__codelineno-0-27"></a><span class="sd">    You can create a MetricEvaluator with a list of MetricSpecs, or use the</span>
<a id="__codelineno-0-28" name="__codelineno-0-28"></a><span class="sd">    EvaluatorBuilder for a more convenient interface.</span>
<a id="__codelineno-0-29" name="__codelineno-0-29"></a>
<a id="__codelineno-0-30" name="__codelineno-0-30"></a><span class="sd">    Methods</span>
<a id="__codelineno-0-31" name="__codelineno-0-31"></a><span class="sd">    -------</span>
<a id="__codelineno-0-32" name="__codelineno-0-32"></a><span class="sd">    add_prob_evaluation(y_true, y_pred, classes=None)</span>
<a id="__codelineno-0-33" name="__codelineno-0-33"></a><span class="sd">        Evaluate PROB metrics and add new step to history.</span>
<a id="__codelineno-0-34" name="__codelineno-0-34"></a><span class="sd">    add_label_evaluation(y_true, y_pred, classes=None)</span>
<a id="__codelineno-0-35" name="__codelineno-0-35"></a><span class="sd">        Evaluate LABEL metrics and add new step to history.</span>
<a id="__codelineno-0-36" name="__codelineno-0-36"></a><span class="sd">    add_model_evaluation(model, X, y_true)</span>
<a id="__codelineno-0-37" name="__codelineno-0-37"></a><span class="sd">        Evaluate a model and all included metrics. This method assumes the model has</span>
<a id="__codelineno-0-38" name="__codelineno-0-38"></a><span class="sd">        predict() and predict_proba() methods.</span>
<a id="__codelineno-0-39" name="__codelineno-0-39"></a><span class="sd">    get_results()</span>
<a id="__codelineno-0-40" name="__codelineno-0-40"></a><span class="sd">        Get evaluation results including reduced values, full history, and plots.</span>
<a id="__codelineno-0-41" name="__codelineno-0-41"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-42" name="__codelineno-0-42"></a>
<a id="__codelineno-0-43" name="__codelineno-0-43"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">metric_specs</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">MetricSpec</span><span class="p">]):</span>
<a id="__codelineno-0-44" name="__codelineno-0-44"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Initialize the MetricEvaluator with a list of MetricSpecs.</span>
<a id="__codelineno-0-45" name="__codelineno-0-45"></a>
<a id="__codelineno-0-46" name="__codelineno-0-46"></a><span class="sd">        Duplicate MetricSpecs (same metric, scope, and class_name) are not allowed,</span>
<a id="__codelineno-0-47" name="__codelineno-0-47"></a><span class="sd">        and will raise a ValueError.</span>
<a id="__codelineno-0-48" name="__codelineno-0-48"></a>
<a id="__codelineno-0-49" name="__codelineno-0-49"></a><span class="sd">        Parameters</span>
<a id="__codelineno-0-50" name="__codelineno-0-50"></a><span class="sd">        ----------</span>
<a id="__codelineno-0-51" name="__codelineno-0-51"></a><span class="sd">        metric_specs : list[MetricSpec]</span>
<a id="__codelineno-0-52" name="__codelineno-0-52"></a><span class="sd">            A list of MetricSpec instances defining the metrics to evaluate.</span>
<a id="__codelineno-0-53" name="__codelineno-0-53"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-54" name="__codelineno-0-54"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_metric_specs</span> <span class="o">=</span> <span class="n">metric_specs</span>
<a id="__codelineno-0-55" name="__codelineno-0-55"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__validate_metric_specs</span><span class="p">()</span>
<a id="__codelineno-0-56" name="__codelineno-0-56"></a>
<a id="__codelineno-0-57" name="__codelineno-0-57"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<a id="__codelineno-0-58" name="__codelineno-0-58"></a>        <span class="n">val</span> <span class="o">=</span> <span class="s2">&quot;MetricEvaluator(</span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-59" name="__codelineno-0-59"></a>        <span class="k">for</span> <span class="n">spec</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_metric_specs</span><span class="p">:</span>
<a id="__codelineno-0-60" name="__codelineno-0-60"></a>            <span class="n">val</span> <span class="o">+=</span> <span class="s2">&quot;  &quot;</span> <span class="o">+</span> <span class="nb">repr</span><span class="p">(</span><span class="n">spec</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;,</span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-61" name="__codelineno-0-61"></a>        <span class="n">val</span> <span class="o">+=</span> <span class="s2">&quot;)&quot;</span>
<a id="__codelineno-0-62" name="__codelineno-0-62"></a>        <span class="k">return</span> <span class="n">val</span>
<a id="__codelineno-0-63" name="__codelineno-0-63"></a>
<a id="__codelineno-0-64" name="__codelineno-0-64"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">add_prob_evaluation</span><span class="p">(</span>
<a id="__codelineno-0-65" name="__codelineno-0-65"></a>        <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-66" name="__codelineno-0-66"></a>        <span class="n">y_true</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
<a id="__codelineno-0-67" name="__codelineno-0-67"></a>        <span class="n">y_pred</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
<a id="__codelineno-0-68" name="__codelineno-0-68"></a>        <span class="n">column_names</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span> <span class="o">|</span> <span class="nb">int</span><span class="p">],</span>
<a id="__codelineno-0-69" name="__codelineno-0-69"></a>    <span class="p">):</span>
<a id="__codelineno-0-70" name="__codelineno-0-70"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Evaluate PROB metrics and add new step to history.</span>
<a id="__codelineno-0-71" name="__codelineno-0-71"></a>
<a id="__codelineno-0-72" name="__codelineno-0-72"></a><span class="sd">        Parameters</span>
<a id="__codelineno-0-73" name="__codelineno-0-73"></a><span class="sd">        ----------</span>
<a id="__codelineno-0-74" name="__codelineno-0-74"></a><span class="sd">        y_true : np.ndarray</span>
<a id="__codelineno-0-75" name="__codelineno-0-75"></a><span class="sd">            True labels. Ints or strings.</span>
<a id="__codelineno-0-76" name="__codelineno-0-76"></a><span class="sd">        y_pred : np.ndarray</span>
<a id="__codelineno-0-77" name="__codelineno-0-77"></a><span class="sd">            Predicted probabilities. Shape (n_samples, n_classes).</span>
<a id="__codelineno-0-78" name="__codelineno-0-78"></a><span class="sd">        column_names : List[str | int],</span>
<a id="__codelineno-0-79" name="__codelineno-0-79"></a><span class="sd">            The names of the columns/classes the input arrays correspond to.</span>
<a id="__codelineno-0-80" name="__codelineno-0-80"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-81" name="__codelineno-0-81"></a>        <span class="n">y_true</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">y_true</span><span class="p">)</span>  <span class="c1"># Ensure numpy array, if not already</span>
<a id="__codelineno-0-82" name="__codelineno-0-82"></a>        <span class="n">y_pred</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">y_pred</span><span class="p">)</span>
<a id="__codelineno-0-83" name="__codelineno-0-83"></a>
<a id="__codelineno-0-84" name="__codelineno-0-84"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__validate_common_inputs</span><span class="p">(</span>
<a id="__codelineno-0-85" name="__codelineno-0-85"></a>            <span class="n">y_true</span><span class="o">=</span><span class="n">y_true</span><span class="p">,</span>
<a id="__codelineno-0-86" name="__codelineno-0-86"></a>            <span class="n">y_pred</span><span class="o">=</span><span class="n">y_pred</span><span class="p">,</span>
<a id="__codelineno-0-87" name="__codelineno-0-87"></a>            <span class="n">column_names</span><span class="o">=</span><span class="n">column_names</span><span class="p">,</span>
<a id="__codelineno-0-88" name="__codelineno-0-88"></a>        <span class="p">)</span>
<a id="__codelineno-0-89" name="__codelineno-0-89"></a>
<a id="__codelineno-0-90" name="__codelineno-0-90"></a>        <span class="c1"># Type checks</span>
<a id="__codelineno-0-91" name="__codelineno-0-91"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span>
<a id="__codelineno-0-92" name="__codelineno-0-92"></a>            <span class="n">np</span><span class="o">.</span><span class="n">issubdtype</span><span class="p">(</span><span class="n">y_true</span><span class="o">.</span><span class="n">dtype</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">integer</span><span class="p">)</span>
<a id="__codelineno-0-93" name="__codelineno-0-93"></a>            <span class="ow">or</span> <span class="n">np</span><span class="o">.</span><span class="n">issubdtype</span><span class="p">(</span><span class="n">y_true</span><span class="o">.</span><span class="n">dtype</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">str_</span><span class="p">)</span>
<a id="__codelineno-0-94" name="__codelineno-0-94"></a>        <span class="p">):</span>
<a id="__codelineno-0-95" name="__codelineno-0-95"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-96" name="__codelineno-0-96"></a>                <span class="s2">&quot;y_true must contain integers or strings for probabilities&quot;</span>
<a id="__codelineno-0-97" name="__codelineno-0-97"></a>            <span class="p">)</span>
<a id="__codelineno-0-98" name="__codelineno-0-98"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">issubdtype</span><span class="p">(</span><span class="n">y_pred</span><span class="o">.</span><span class="n">dtype</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">floating</span><span class="p">):</span>
<a id="__codelineno-0-99" name="__codelineno-0-99"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;y_pred must contain floats for probabilities&quot;</span><span class="p">)</span>
<a id="__codelineno-0-100" name="__codelineno-0-100"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">((</span><span class="n">y_pred</span> <span class="o">&gt;=</span> <span class="mf">0.0</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">y_pred</span> <span class="o">&lt;=</span> <span class="mf">1.0</span><span class="p">)):</span>
<a id="__codelineno-0-101" name="__codelineno-0-101"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-102" name="__codelineno-0-102"></a>                <span class="s2">&quot;y_pred must contain probabilities in the range [0.0, 1.0]&quot;</span>
<a id="__codelineno-0-103" name="__codelineno-0-103"></a>            <span class="p">)</span>
<a id="__codelineno-0-104" name="__codelineno-0-104"></a>
<a id="__codelineno-0-105" name="__codelineno-0-105"></a>        <span class="c1"># Get PROB metric specs and compute</span>
<a id="__codelineno-0-106" name="__codelineno-0-106"></a>        <span class="n">prob_specs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__get_prob_specs</span><span class="p">()</span>
<a id="__codelineno-0-107" name="__codelineno-0-107"></a>        <span class="k">for</span> <span class="n">spec</span> <span class="ow">in</span> <span class="n">prob_specs</span><span class="p">:</span>
<a id="__codelineno-0-108" name="__codelineno-0-108"></a>            <span class="n">spec</span><span class="o">.</span><span class="n">compute</span><span class="p">(</span>
<a id="__codelineno-0-109" name="__codelineno-0-109"></a>                <span class="n">y_true</span><span class="o">=</span><span class="n">y_true</span><span class="p">,</span>
<a id="__codelineno-0-110" name="__codelineno-0-110"></a>                <span class="n">y_pred</span><span class="o">=</span><span class="n">y_pred</span><span class="p">,</span>
<a id="__codelineno-0-111" name="__codelineno-0-111"></a>                <span class="n">column_names</span><span class="o">=</span><span class="n">column_names</span><span class="p">,</span>
<a id="__codelineno-0-112" name="__codelineno-0-112"></a>            <span class="p">)</span>
<a id="__codelineno-0-113" name="__codelineno-0-113"></a>
<a id="__codelineno-0-114" name="__codelineno-0-114"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">add_label_evaluation</span><span class="p">(</span>
<a id="__codelineno-0-115" name="__codelineno-0-115"></a>        <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-116" name="__codelineno-0-116"></a>        <span class="n">y_true</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
<a id="__codelineno-0-117" name="__codelineno-0-117"></a>        <span class="n">y_pred</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
<a id="__codelineno-0-118" name="__codelineno-0-118"></a>        <span class="n">column_names</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span> <span class="o">|</span> <span class="nb">int</span><span class="p">],</span>
<a id="__codelineno-0-119" name="__codelineno-0-119"></a>    <span class="p">):</span>
<a id="__codelineno-0-120" name="__codelineno-0-120"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Evaluate LABEL metrics and add new step to history.</span>
<a id="__codelineno-0-121" name="__codelineno-0-121"></a>
<a id="__codelineno-0-122" name="__codelineno-0-122"></a><span class="sd">        Parameters</span>
<a id="__codelineno-0-123" name="__codelineno-0-123"></a><span class="sd">        ----------</span>
<a id="__codelineno-0-124" name="__codelineno-0-124"></a><span class="sd">        y_true : np.ndarray</span>
<a id="__codelineno-0-125" name="__codelineno-0-125"></a><span class="sd">            True labels. Ints or strings.</span>
<a id="__codelineno-0-126" name="__codelineno-0-126"></a><span class="sd">        y_pred : np.ndarray</span>
<a id="__codelineno-0-127" name="__codelineno-0-127"></a><span class="sd">            Predicted labels. Ints or strings.</span>
<a id="__codelineno-0-128" name="__codelineno-0-128"></a><span class="sd">        column_names : List[str | int],</span>
<a id="__codelineno-0-129" name="__codelineno-0-129"></a><span class="sd">            The names of the columns/classes the input arrays correspond to.</span>
<a id="__codelineno-0-130" name="__codelineno-0-130"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-131" name="__codelineno-0-131"></a>        <span class="n">y_true</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">y_true</span><span class="p">)</span>  <span class="c1"># Ensure numpy array, if not already</span>
<a id="__codelineno-0-132" name="__codelineno-0-132"></a>        <span class="n">y_pred</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">y_pred</span><span class="p">)</span>
<a id="__codelineno-0-133" name="__codelineno-0-133"></a>
<a id="__codelineno-0-134" name="__codelineno-0-134"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__validate_common_inputs</span><span class="p">(</span>
<a id="__codelineno-0-135" name="__codelineno-0-135"></a>            <span class="n">y_true</span><span class="o">=</span><span class="n">y_true</span><span class="p">,</span>
<a id="__codelineno-0-136" name="__codelineno-0-136"></a>            <span class="n">y_pred</span><span class="o">=</span><span class="n">y_pred</span><span class="p">,</span>
<a id="__codelineno-0-137" name="__codelineno-0-137"></a>            <span class="n">column_names</span><span class="o">=</span><span class="n">column_names</span><span class="p">,</span>
<a id="__codelineno-0-138" name="__codelineno-0-138"></a>        <span class="p">)</span>
<a id="__codelineno-0-139" name="__codelineno-0-139"></a>        <span class="c1"># Type checks</span>
<a id="__codelineno-0-140" name="__codelineno-0-140"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span>
<a id="__codelineno-0-141" name="__codelineno-0-141"></a>            <span class="n">np</span><span class="o">.</span><span class="n">issubdtype</span><span class="p">(</span><span class="n">y_true</span><span class="o">.</span><span class="n">dtype</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">integer</span><span class="p">)</span>
<a id="__codelineno-0-142" name="__codelineno-0-142"></a>            <span class="ow">or</span> <span class="n">np</span><span class="o">.</span><span class="n">issubdtype</span><span class="p">(</span><span class="n">y_true</span><span class="o">.</span><span class="n">dtype</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">str_</span><span class="p">)</span>
<a id="__codelineno-0-143" name="__codelineno-0-143"></a>        <span class="p">):</span>
<a id="__codelineno-0-144" name="__codelineno-0-144"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;y_true must contain integers or strings for labels&quot;</span><span class="p">)</span>
<a id="__codelineno-0-145" name="__codelineno-0-145"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span>
<a id="__codelineno-0-146" name="__codelineno-0-146"></a>            <span class="n">np</span><span class="o">.</span><span class="n">issubdtype</span><span class="p">(</span><span class="n">y_pred</span><span class="o">.</span><span class="n">dtype</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">integer</span><span class="p">)</span>
<a id="__codelineno-0-147" name="__codelineno-0-147"></a>            <span class="ow">or</span> <span class="n">np</span><span class="o">.</span><span class="n">issubdtype</span><span class="p">(</span><span class="n">y_pred</span><span class="o">.</span><span class="n">dtype</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">str_</span><span class="p">)</span>
<a id="__codelineno-0-148" name="__codelineno-0-148"></a>        <span class="p">):</span>
<a id="__codelineno-0-149" name="__codelineno-0-149"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;y_pred must contain integers or strings for labels&quot;</span><span class="p">)</span>
<a id="__codelineno-0-150" name="__codelineno-0-150"></a>
<a id="__codelineno-0-151" name="__codelineno-0-151"></a>        <span class="c1"># Get LABEL metric specs and compute</span>
<a id="__codelineno-0-152" name="__codelineno-0-152"></a>        <span class="n">label_specs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__get_label_specs</span><span class="p">()</span>
<a id="__codelineno-0-153" name="__codelineno-0-153"></a>        <span class="k">for</span> <span class="n">spec</span> <span class="ow">in</span> <span class="n">label_specs</span><span class="p">:</span>
<a id="__codelineno-0-154" name="__codelineno-0-154"></a>            <span class="n">spec</span><span class="o">.</span><span class="n">compute</span><span class="p">(</span>
<a id="__codelineno-0-155" name="__codelineno-0-155"></a>                <span class="n">y_true</span><span class="o">=</span><span class="n">y_true</span><span class="p">,</span>
<a id="__codelineno-0-156" name="__codelineno-0-156"></a>                <span class="n">y_pred</span><span class="o">=</span><span class="n">y_pred</span><span class="p">,</span>
<a id="__codelineno-0-157" name="__codelineno-0-157"></a>                <span class="n">column_names</span><span class="o">=</span><span class="n">column_names</span><span class="p">,</span>
<a id="__codelineno-0-158" name="__codelineno-0-158"></a>            <span class="p">)</span>
<a id="__codelineno-0-159" name="__codelineno-0-159"></a>
<a id="__codelineno-0-160" name="__codelineno-0-160"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">add_regression_evaluation</span><span class="p">(</span>
<a id="__codelineno-0-161" name="__codelineno-0-161"></a>        <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-162" name="__codelineno-0-162"></a>        <span class="n">y_true</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
<a id="__codelineno-0-163" name="__codelineno-0-163"></a>        <span class="n">y_pred</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
<a id="__codelineno-0-164" name="__codelineno-0-164"></a>        <span class="n">column_names</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span> <span class="o">|</span> <span class="nb">int</span><span class="p">],</span>
<a id="__codelineno-0-165" name="__codelineno-0-165"></a>    <span class="p">):</span>
<a id="__codelineno-0-166" name="__codelineno-0-166"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Evaluate SCORE metrics and add new step to history.</span>
<a id="__codelineno-0-167" name="__codelineno-0-167"></a>
<a id="__codelineno-0-168" name="__codelineno-0-168"></a><span class="sd">        Parameters</span>
<a id="__codelineno-0-169" name="__codelineno-0-169"></a><span class="sd">        ----------</span>
<a id="__codelineno-0-170" name="__codelineno-0-170"></a><span class="sd">        y_true : np.ndarray</span>
<a id="__codelineno-0-171" name="__codelineno-0-171"></a><span class="sd">            True series values. Shape (n_samples, n_targets).</span>
<a id="__codelineno-0-172" name="__codelineno-0-172"></a><span class="sd">        y_pred : np.ndarray</span>
<a id="__codelineno-0-173" name="__codelineno-0-173"></a><span class="sd">            Predicted series values. Shape (n_samples, n_targets).</span>
<a id="__codelineno-0-174" name="__codelineno-0-174"></a><span class="sd">        column_names : List[str | int],</span>
<a id="__codelineno-0-175" name="__codelineno-0-175"></a><span class="sd">            The names of the columns/classes the input arrays correspond to.</span>
<a id="__codelineno-0-176" name="__codelineno-0-176"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-177" name="__codelineno-0-177"></a>        <span class="n">y_true</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">y_true</span><span class="p">)</span>  <span class="c1"># Ensure numpy array, if not already</span>
<a id="__codelineno-0-178" name="__codelineno-0-178"></a>        <span class="n">y_pred</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">y_pred</span><span class="p">)</span>
<a id="__codelineno-0-179" name="__codelineno-0-179"></a>
<a id="__codelineno-0-180" name="__codelineno-0-180"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__validate_common_inputs</span><span class="p">(</span>
<a id="__codelineno-0-181" name="__codelineno-0-181"></a>            <span class="n">y_true</span><span class="o">=</span><span class="n">y_true</span><span class="p">,</span>
<a id="__codelineno-0-182" name="__codelineno-0-182"></a>            <span class="n">y_pred</span><span class="o">=</span><span class="n">y_pred</span><span class="p">,</span>
<a id="__codelineno-0-183" name="__codelineno-0-183"></a>            <span class="n">column_names</span><span class="o">=</span><span class="n">column_names</span><span class="p">,</span>
<a id="__codelineno-0-184" name="__codelineno-0-184"></a>        <span class="p">)</span>
<a id="__codelineno-0-185" name="__codelineno-0-185"></a>
<a id="__codelineno-0-186" name="__codelineno-0-186"></a>        <span class="c1"># Get SCORE metric specs and compute</span>
<a id="__codelineno-0-187" name="__codelineno-0-187"></a>        <span class="n">score_specs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__get_regression_specs</span><span class="p">()</span>
<a id="__codelineno-0-188" name="__codelineno-0-188"></a>        <span class="k">for</span> <span class="n">spec</span> <span class="ow">in</span> <span class="n">score_specs</span><span class="p">:</span>
<a id="__codelineno-0-189" name="__codelineno-0-189"></a>            <span class="n">spec</span><span class="o">.</span><span class="n">compute</span><span class="p">(</span>
<a id="__codelineno-0-190" name="__codelineno-0-190"></a>                <span class="n">y_true</span><span class="o">=</span><span class="n">y_true</span><span class="p">,</span>
<a id="__codelineno-0-191" name="__codelineno-0-191"></a>                <span class="n">y_pred</span><span class="o">=</span><span class="n">y_pred</span><span class="p">,</span>
<a id="__codelineno-0-192" name="__codelineno-0-192"></a>                <span class="n">column_names</span><span class="o">=</span><span class="n">column_names</span><span class="p">,</span>
<a id="__codelineno-0-193" name="__codelineno-0-193"></a>            <span class="p">)</span>
<a id="__codelineno-0-194" name="__codelineno-0-194"></a>
<a id="__codelineno-0-195" name="__codelineno-0-195"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">add_model_evaluation</span><span class="p">(</span>
<a id="__codelineno-0-196" name="__codelineno-0-196"></a>        <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-197" name="__codelineno-0-197"></a>        <span class="n">model</span><span class="p">,</span>
<a id="__codelineno-0-198" name="__codelineno-0-198"></a>        <span class="n">X</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
<a id="__codelineno-0-199" name="__codelineno-0-199"></a>        <span class="n">y_true</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
<a id="__codelineno-0-200" name="__codelineno-0-200"></a>        <span class="n">column_names</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span> <span class="o">|</span> <span class="nb">int</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-201" name="__codelineno-0-201"></a>    <span class="p">):</span>
<a id="__codelineno-0-202" name="__codelineno-0-202"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Evaluate a model and all included metrics.</span>
<a id="__codelineno-0-203" name="__codelineno-0-203"></a>
<a id="__codelineno-0-204" name="__codelineno-0-204"></a><span class="sd">        This method does not know what your model **predict()** method returns,</span>
<a id="__codelineno-0-205" name="__codelineno-0-205"></a><span class="sd">        and it is assumed you only include compatible metrics in the evaluator.</span>
<a id="__codelineno-0-206" name="__codelineno-0-206"></a><span class="sd">        For example, classifier and regressor have the same predict() method signature,</span>
<a id="__codelineno-0-207" name="__codelineno-0-207"></a><span class="sd">        but you should not mix classification and regression metrics in the same evaluator.</span>
<a id="__codelineno-0-208" name="__codelineno-0-208"></a>
<a id="__codelineno-0-209" name="__codelineno-0-209"></a><span class="sd">        Mixing is allowed if you use the lower-level:</span>
<a id="__codelineno-0-210" name="__codelineno-0-210"></a>
<a id="__codelineno-0-211" name="__codelineno-0-211"></a><span class="sd">        - **add_label_evaluation()**</span>
<a id="__codelineno-0-212" name="__codelineno-0-212"></a>
<a id="__codelineno-0-213" name="__codelineno-0-213"></a><span class="sd">        - **add_prob_evaluation()**</span>
<a id="__codelineno-0-214" name="__codelineno-0-214"></a>
<a id="__codelineno-0-215" name="__codelineno-0-215"></a><span class="sd">        - **add_regression_evaluation()**</span>
<a id="__codelineno-0-216" name="__codelineno-0-216"></a>
<a id="__codelineno-0-217" name="__codelineno-0-217"></a><span class="sd">        and you are able to inherit the Evaluator and create your own model evaluation logic.</span>
<a id="__codelineno-0-218" name="__codelineno-0-218"></a><span class="sd">        You can build custom evaluators using the **EvaluatorBuilder**,</span>
<a id="__codelineno-0-219" name="__codelineno-0-219"></a><span class="sd">        by passing your custom evaluator class to the **build()** method.</span>
<a id="__codelineno-0-220" name="__codelineno-0-220"></a>
<a id="__codelineno-0-221" name="__codelineno-0-221"></a><span class="sd">        Parameters</span>
<a id="__codelineno-0-222" name="__codelineno-0-222"></a><span class="sd">        ----------</span>
<a id="__codelineno-0-223" name="__codelineno-0-223"></a><span class="sd">        model : Any</span>
<a id="__codelineno-0-224" name="__codelineno-0-224"></a><span class="sd">            A model with predict and predict_proba methods.</span>
<a id="__codelineno-0-225" name="__codelineno-0-225"></a><span class="sd">        X : np.ndarray</span>
<a id="__codelineno-0-226" name="__codelineno-0-226"></a><span class="sd">            Input features for prediction.</span>
<a id="__codelineno-0-227" name="__codelineno-0-227"></a><span class="sd">        y_true : np.ndarray</span>
<a id="__codelineno-0-228" name="__codelineno-0-228"></a><span class="sd">            True labels. Ints or strings.</span>
<a id="__codelineno-0-229" name="__codelineno-0-229"></a><span class="sd">        column_names : Optional[List[str | int]] = None</span>
<a id="__codelineno-0-230" name="__codelineno-0-230"></a><span class="sd">            Optional list of column names to use for evaluation.</span>
<a id="__codelineno-0-231" name="__codelineno-0-231"></a><span class="sd">            If not provided, will attempt to infer from model classes or use default indices.</span>
<a id="__codelineno-0-232" name="__codelineno-0-232"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-233" name="__codelineno-0-233"></a>
<a id="__codelineno-0-234" name="__codelineno-0-234"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">__get_label_specs</span><span class="p">():</span>  <span class="c1"># If there are LABEL metrics to evaluate</span>
<a id="__codelineno-0-235" name="__codelineno-0-235"></a>            <span class="n">classes</span> <span class="o">=</span> <span class="p">(</span>
<a id="__codelineno-0-236" name="__codelineno-0-236"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">__get_model_classes</span><span class="p">(</span><span class="n">model</span><span class="p">)</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">column_names</span> <span class="k">else</span> <span class="n">column_names</span>
<a id="__codelineno-0-237" name="__codelineno-0-237"></a>            <span class="p">)</span>
<a id="__codelineno-0-238" name="__codelineno-0-238"></a>            <span class="n">y_pred</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
<a id="__codelineno-0-239" name="__codelineno-0-239"></a>            <span class="n">y_pred</span> <span class="o">=</span> <span class="n">toolbox_binarize_labels</span><span class="p">(</span><span class="n">y_pred</span><span class="p">,</span> <span class="n">classes</span><span class="p">)</span>
<a id="__codelineno-0-240" name="__codelineno-0-240"></a>            <span class="n">y_true</span> <span class="o">=</span> <span class="n">toolbox_binarize_labels</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">classes</span><span class="p">)</span>
<a id="__codelineno-0-241" name="__codelineno-0-241"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">add_label_evaluation</span><span class="p">(</span>
<a id="__codelineno-0-242" name="__codelineno-0-242"></a>                <span class="n">y_true</span><span class="o">=</span><span class="n">y_true</span><span class="p">,</span>
<a id="__codelineno-0-243" name="__codelineno-0-243"></a>                <span class="n">y_pred</span><span class="o">=</span><span class="n">y_pred</span><span class="p">,</span>
<a id="__codelineno-0-244" name="__codelineno-0-244"></a>                <span class="n">column_names</span><span class="o">=</span><span class="n">classes</span><span class="p">,</span>
<a id="__codelineno-0-245" name="__codelineno-0-245"></a>            <span class="p">)</span>
<a id="__codelineno-0-246" name="__codelineno-0-246"></a>
<a id="__codelineno-0-247" name="__codelineno-0-247"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">__get_prob_specs</span><span class="p">():</span>  <span class="c1"># If there are PROB metrics to evaluate</span>
<a id="__codelineno-0-248" name="__codelineno-0-248"></a>            <span class="n">classes</span> <span class="o">=</span> <span class="p">(</span>
<a id="__codelineno-0-249" name="__codelineno-0-249"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">__get_model_classes</span><span class="p">(</span><span class="n">model</span><span class="p">)</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">column_names</span> <span class="k">else</span> <span class="n">column_names</span>
<a id="__codelineno-0-250" name="__codelineno-0-250"></a>            <span class="p">)</span>
<a id="__codelineno-0-251" name="__codelineno-0-251"></a>            <span class="n">y_pred</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
<a id="__codelineno-0-252" name="__codelineno-0-252"></a>            <span class="n">y_pred</span> <span class="o">=</span> <span class="n">toolbox_binarize_probs</span><span class="p">(</span><span class="n">y_pred</span><span class="p">)</span>
<a id="__codelineno-0-253" name="__codelineno-0-253"></a>            <span class="n">y_true</span> <span class="o">=</span> <span class="n">toolbox_binarize_labels</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">classes</span><span class="p">)</span>
<a id="__codelineno-0-254" name="__codelineno-0-254"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">add_prob_evaluation</span><span class="p">(</span>
<a id="__codelineno-0-255" name="__codelineno-0-255"></a>                <span class="n">y_true</span><span class="o">=</span><span class="n">y_true</span><span class="p">,</span>
<a id="__codelineno-0-256" name="__codelineno-0-256"></a>                <span class="n">y_pred</span><span class="o">=</span><span class="n">y_pred</span><span class="p">,</span>
<a id="__codelineno-0-257" name="__codelineno-0-257"></a>                <span class="n">column_names</span><span class="o">=</span><span class="n">classes</span><span class="p">,</span>
<a id="__codelineno-0-258" name="__codelineno-0-258"></a>            <span class="p">)</span>
<a id="__codelineno-0-259" name="__codelineno-0-259"></a>
<a id="__codelineno-0-260" name="__codelineno-0-260"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">__get_regression_specs</span><span class="p">():</span>  <span class="c1"># If there are regression metrics to evaluate</span>
<a id="__codelineno-0-261" name="__codelineno-0-261"></a>            <span class="n">column_names</span> <span class="o">=</span> <span class="p">(</span>
<a id="__codelineno-0-262" name="__codelineno-0-262"></a>                <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">y_true</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">column_names</span> <span class="k">else</span> <span class="n">column_names</span>
<a id="__codelineno-0-263" name="__codelineno-0-263"></a>            <span class="p">)</span>
<a id="__codelineno-0-264" name="__codelineno-0-264"></a>            <span class="n">y_pred</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
<a id="__codelineno-0-265" name="__codelineno-0-265"></a>            <span class="n">y_pred</span> <span class="o">=</span> <span class="n">toolbox_widen_series</span><span class="p">(</span><span class="n">y_pred</span><span class="p">)</span>
<a id="__codelineno-0-266" name="__codelineno-0-266"></a>            <span class="n">y_true</span> <span class="o">=</span> <span class="n">toolbox_widen_series</span><span class="p">(</span><span class="n">y_true</span><span class="p">)</span>
<a id="__codelineno-0-267" name="__codelineno-0-267"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">add_regression_evaluation</span><span class="p">(</span>
<a id="__codelineno-0-268" name="__codelineno-0-268"></a>                <span class="n">y_true</span><span class="o">=</span><span class="n">y_true</span><span class="p">,</span>
<a id="__codelineno-0-269" name="__codelineno-0-269"></a>                <span class="n">y_pred</span><span class="o">=</span><span class="n">y_pred</span><span class="p">,</span>
<a id="__codelineno-0-270" name="__codelineno-0-270"></a>                <span class="n">column_names</span><span class="o">=</span><span class="n">column_names</span><span class="p">,</span>
<a id="__codelineno-0-271" name="__codelineno-0-271"></a>            <span class="p">)</span>
<a id="__codelineno-0-272" name="__codelineno-0-272"></a>
<a id="__codelineno-0-273" name="__codelineno-0-273"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_results</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">|</span> <span class="n">plt</span><span class="o">.</span><span class="n">Figure</span><span class="p">]]:</span>
<a id="__codelineno-0-274" name="__codelineno-0-274"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Get evaluation results including reduced values, full history, and plots.</span>
<a id="__codelineno-0-275" name="__codelineno-0-275"></a>
<a id="__codelineno-0-276" name="__codelineno-0-276"></a><span class="sd">        Returns</span>
<a id="__codelineno-0-277" name="__codelineno-0-277"></a><span class="sd">        -------</span>
<a id="__codelineno-0-278" name="__codelineno-0-278"></a><span class="sd">        Dict[str, Dict[str, float | list[float] | plt.Figure]]</span>
<a id="__codelineno-0-279" name="__codelineno-0-279"></a><span class="sd">            A dictionary with keys &#39;values&#39;, &#39;steps&#39;, and &#39;figures&#39;.</span>
<a id="__codelineno-0-280" name="__codelineno-0-280"></a>
<a id="__codelineno-0-281" name="__codelineno-0-281"></a><span class="sd">            - **values**: Reduced metric values (e.g., mean, max).</span>
<a id="__codelineno-0-282" name="__codelineno-0-282"></a>
<a id="__codelineno-0-283" name="__codelineno-0-283"></a><span class="sd">            - **steps**: Full history of metric values over evaluation steps.</span>
<a id="__codelineno-0-284" name="__codelineno-0-284"></a>
<a id="__codelineno-0-285" name="__codelineno-0-285"></a><span class="sd">            - **figures**: Plots for applicable metrics (e.g., ROC AUC curves).</span>
<a id="__codelineno-0-286" name="__codelineno-0-286"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-287" name="__codelineno-0-287"></a>
<a id="__codelineno-0-288" name="__codelineno-0-288"></a>        <span class="n">summary</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">|</span> <span class="n">plt</span><span class="o">.</span><span class="n">Figure</span><span class="p">]]</span> <span class="o">=</span> <span class="p">{</span>
<a id="__codelineno-0-289" name="__codelineno-0-289"></a>            <span class="s2">&quot;values&quot;</span><span class="p">:</span> <span class="p">{},</span>
<a id="__codelineno-0-290" name="__codelineno-0-290"></a>            <span class="s2">&quot;steps&quot;</span><span class="p">:</span> <span class="p">{},</span>
<a id="__codelineno-0-291" name="__codelineno-0-291"></a>            <span class="s2">&quot;figures&quot;</span><span class="p">:</span> <span class="p">{},</span>
<a id="__codelineno-0-292" name="__codelineno-0-292"></a>        <span class="p">}</span>
<a id="__codelineno-0-293" name="__codelineno-0-293"></a>
<a id="__codelineno-0-294" name="__codelineno-0-294"></a>        <span class="k">def</span><span class="w"> </span><span class="nf">get_reduced_values</span><span class="p">(</span><span class="n">specs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">]:</span>
<a id="__codelineno-0-295" name="__codelineno-0-295"></a><span class="w">            </span><span class="sd">&quot;&quot;&quot;Iterate over specs and fill reduced values.&quot;&quot;&quot;</span>
<a id="__codelineno-0-296" name="__codelineno-0-296"></a>            <span class="n">reduced</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-0-297" name="__codelineno-0-297"></a>            <span class="k">for</span> <span class="n">spec</span> <span class="ow">in</span> <span class="n">specs</span><span class="p">:</span>
<a id="__codelineno-0-298" name="__codelineno-0-298"></a>                <span class="n">reduced</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">spec</span><span class="o">.</span><span class="n">get_reduced_values</span><span class="p">())</span>  <span class="c1"># {roc_auc_mean: 0.85, ...}</span>
<a id="__codelineno-0-299" name="__codelineno-0-299"></a>            <span class="k">return</span> <span class="n">reduced</span>
<a id="__codelineno-0-300" name="__codelineno-0-300"></a>
<a id="__codelineno-0-301" name="__codelineno-0-301"></a>        <span class="k">def</span><span class="w"> </span><span class="nf">get_full_history</span><span class="p">(</span><span class="n">specs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]]:</span>
<a id="__codelineno-0-302" name="__codelineno-0-302"></a><span class="w">            </span><span class="sd">&quot;&quot;&quot;Iterate over specs ids in history and get full values over given</span>
<a id="__codelineno-0-303" name="__codelineno-0-303"></a><span class="sd">            specs.&quot;&quot;&quot;</span>
<a id="__codelineno-0-304" name="__codelineno-0-304"></a>            <span class="n">history</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-0-305" name="__codelineno-0-305"></a>            <span class="k">for</span> <span class="n">spec</span> <span class="ow">in</span> <span class="n">specs</span><span class="p">:</span>
<a id="__codelineno-0-306" name="__codelineno-0-306"></a>                <span class="n">history</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">spec</span><span class="o">.</span><span class="n">id</span><span class="si">}</span><span class="s2">_steps&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
<a id="__codelineno-0-307" name="__codelineno-0-307"></a>                    <span class="n">spec</span><span class="o">.</span><span class="n">get_values_history</span><span class="p">()</span>
<a id="__codelineno-0-308" name="__codelineno-0-308"></a>                <span class="p">)</span>  <span class="c1"># {roc_auc_steps: [0.8, 0.85, ...], ...}</span>
<a id="__codelineno-0-309" name="__codelineno-0-309"></a>            <span class="k">return</span> <span class="n">history</span>
<a id="__codelineno-0-310" name="__codelineno-0-310"></a>
<a id="__codelineno-0-311" name="__codelineno-0-311"></a>        <span class="k">def</span><span class="w"> </span><span class="nf">get_roc_auc_plots</span><span class="p">(</span><span class="n">specs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">plt</span><span class="o">.</span><span class="n">Figure</span><span class="p">]:</span>
<a id="__codelineno-0-312" name="__codelineno-0-312"></a><span class="w">            </span><span class="sd">&quot;&quot;&quot;Generate ROC AUC plots for given specs.&quot;&quot;&quot;</span>
<a id="__codelineno-0-313" name="__codelineno-0-313"></a>            <span class="n">roc_auc_results</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-0-314" name="__codelineno-0-314"></a>            <span class="k">for</span> <span class="n">spec</span> <span class="ow">in</span> <span class="n">specs</span><span class="p">:</span>
<a id="__codelineno-0-315" name="__codelineno-0-315"></a>                <span class="k">if</span> <span class="n">spec</span><span class="o">.</span><span class="n">metric</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="n">MetricNameEnum</span><span class="o">.</span><span class="n">ROC_AUC</span><span class="p">:</span>
<a id="__codelineno-0-316" name="__codelineno-0-316"></a>                    <span class="n">roc_auc_results</span><span class="p">[</span><span class="n">spec</span><span class="o">.</span><span class="n">id</span><span class="p">]</span> <span class="o">=</span> <span class="n">spec</span><span class="o">.</span><span class="n">get_results_history</span><span class="p">()</span>
<a id="__codelineno-0-317" name="__codelineno-0-317"></a>            <span class="k">if</span> <span class="n">roc_auc_results</span><span class="p">:</span>
<a id="__codelineno-0-318" name="__codelineno-0-318"></a>                <span class="n">fig</span> <span class="o">=</span> <span class="n">plot_auc_curves</span><span class="p">(</span>
<a id="__codelineno-0-319" name="__codelineno-0-319"></a>                    <span class="n">auc_metrics</span><span class="o">=</span><span class="n">roc_auc_results</span><span class="p">,</span>
<a id="__codelineno-0-320" name="__codelineno-0-320"></a>                    <span class="n">is_roc</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-321" name="__codelineno-0-321"></a>                <span class="p">)</span>
<a id="__codelineno-0-322" name="__codelineno-0-322"></a>                <span class="k">return</span> <span class="p">{</span><span class="s2">&quot;roc_auc_curves&quot;</span><span class="p">:</span> <span class="n">fig</span><span class="p">}</span>
<a id="__codelineno-0-323" name="__codelineno-0-323"></a>            <span class="k">return</span> <span class="p">{}</span>
<a id="__codelineno-0-324" name="__codelineno-0-324"></a>
<a id="__codelineno-0-325" name="__codelineno-0-325"></a>        <span class="k">def</span><span class="w"> </span><span class="nf">get_confusion_matrix_plots</span><span class="p">(</span><span class="n">specs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">plt</span><span class="o">.</span><span class="n">Figure</span><span class="p">]:</span>
<a id="__codelineno-0-326" name="__codelineno-0-326"></a><span class="w">            </span><span class="sd">&quot;&quot;&quot;Generate Confusion Matrix plots for given specs.&quot;&quot;&quot;</span>
<a id="__codelineno-0-327" name="__codelineno-0-327"></a>            <span class="n">cm_results</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-328" name="__codelineno-0-328"></a>            <span class="k">for</span> <span class="n">spec</span> <span class="ow">in</span> <span class="n">specs</span><span class="p">:</span>
<a id="__codelineno-0-329" name="__codelineno-0-329"></a>                <span class="k">if</span> <span class="p">(</span>
<a id="__codelineno-0-330" name="__codelineno-0-330"></a>                    <span class="n">spec</span><span class="o">.</span><span class="n">metric</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="n">MetricNameEnum</span><span class="o">.</span><span class="n">ACCURACY</span>
<a id="__codelineno-0-331" name="__codelineno-0-331"></a>                <span class="p">):</span>  <span class="c1"># All accuracy metrics have cf in metadata</span>
<a id="__codelineno-0-332" name="__codelineno-0-332"></a>                    <span class="n">cm_results</span> <span class="o">=</span> <span class="n">spec</span><span class="o">.</span><span class="n">get_results_history</span><span class="p">()</span>
<a id="__codelineno-0-333" name="__codelineno-0-333"></a>            <span class="k">if</span> <span class="n">cm_results</span><span class="p">:</span>
<a id="__codelineno-0-334" name="__codelineno-0-334"></a>                <span class="n">fig</span> <span class="o">=</span> <span class="n">plot_confusion_matrix</span><span class="p">(</span>
<a id="__codelineno-0-335" name="__codelineno-0-335"></a>                    <span class="n">accuracy_results</span><span class="o">=</span><span class="n">cm_results</span><span class="p">,</span>
<a id="__codelineno-0-336" name="__codelineno-0-336"></a>                <span class="p">)</span>
<a id="__codelineno-0-337" name="__codelineno-0-337"></a>                <span class="k">return</span> <span class="p">{</span><span class="s2">&quot;confusion_matrices&quot;</span><span class="p">:</span> <span class="n">fig</span><span class="p">}</span>
<a id="__codelineno-0-338" name="__codelineno-0-338"></a>            <span class="k">return</span> <span class="p">{}</span>
<a id="__codelineno-0-339" name="__codelineno-0-339"></a>
<a id="__codelineno-0-340" name="__codelineno-0-340"></a>        <span class="k">def</span><span class="w"> </span><span class="nf">get_regression_plots</span><span class="p">(</span><span class="n">specs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">plt</span><span class="o">.</span><span class="n">Figure</span><span class="p">]:</span>
<a id="__codelineno-0-341" name="__codelineno-0-341"></a><span class="w">            </span><span class="sd">&quot;&quot;&quot;Generate regression plots for given specs.&quot;&quot;&quot;</span>
<a id="__codelineno-0-342" name="__codelineno-0-342"></a>            <span class="n">target_regression_results</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-0-343" name="__codelineno-0-343"></a>            <span class="k">for</span> <span class="n">spec</span> <span class="ow">in</span> <span class="n">specs</span><span class="p">:</span>
<a id="__codelineno-0-344" name="__codelineno-0-344"></a>                <span class="k">if</span> <span class="p">(</span>
<a id="__codelineno-0-345" name="__codelineno-0-345"></a>                    <span class="n">spec</span><span class="o">.</span><span class="n">metric</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="n">MetricTypeEnum</span><span class="o">.</span><span class="n">SCORES</span>
<a id="__codelineno-0-346" name="__codelineno-0-346"></a>                    <span class="ow">and</span> <span class="n">spec</span><span class="o">.</span><span class="n">metric</span><span class="o">.</span><span class="n">scope</span> <span class="o">==</span> <span class="n">MetricScopeEnum</span><span class="o">.</span><span class="n">TARGET</span>
<a id="__codelineno-0-347" name="__codelineno-0-347"></a>                <span class="p">):</span>
<a id="__codelineno-0-348" name="__codelineno-0-348"></a>                    <span class="n">target_regression_results</span><span class="p">[</span><span class="n">spec</span><span class="o">.</span><span class="n">id</span><span class="p">]</span> <span class="o">=</span> <span class="n">spec</span><span class="o">.</span><span class="n">get_results_history</span><span class="p">()</span>
<a id="__codelineno-0-349" name="__codelineno-0-349"></a>            <span class="k">if</span> <span class="n">target_regression_results</span><span class="p">:</span>
<a id="__codelineno-0-350" name="__codelineno-0-350"></a>                <span class="n">fig</span> <span class="o">=</span> <span class="n">plot_regression_lines</span><span class="p">(</span>
<a id="__codelineno-0-351" name="__codelineno-0-351"></a>                    <span class="n">regression_results</span><span class="o">=</span><span class="n">target_regression_results</span><span class="p">,</span>
<a id="__codelineno-0-352" name="__codelineno-0-352"></a>                <span class="p">)</span>
<a id="__codelineno-0-353" name="__codelineno-0-353"></a>                <span class="k">return</span> <span class="p">{</span><span class="s2">&quot;regression_plots&quot;</span><span class="p">:</span> <span class="n">fig</span><span class="p">}</span>
<a id="__codelineno-0-354" name="__codelineno-0-354"></a>            <span class="k">return</span> <span class="p">{}</span>
<a id="__codelineno-0-355" name="__codelineno-0-355"></a>
<a id="__codelineno-0-356" name="__codelineno-0-356"></a>        <span class="n">summary</span><span class="p">[</span><span class="s2">&quot;values&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">get_reduced_values</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_metric_specs</span><span class="p">))</span>
<a id="__codelineno-0-357" name="__codelineno-0-357"></a>        <span class="n">summary</span><span class="p">[</span><span class="s2">&quot;steps&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">get_full_history</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_metric_specs</span><span class="p">))</span>
<a id="__codelineno-0-358" name="__codelineno-0-358"></a>        <span class="n">summary</span><span class="p">[</span><span class="s2">&quot;figures&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">get_roc_auc_plots</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_metric_specs</span><span class="p">))</span>
<a id="__codelineno-0-359" name="__codelineno-0-359"></a>        <span class="n">summary</span><span class="p">[</span><span class="s2">&quot;figures&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">get_confusion_matrix_plots</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_metric_specs</span><span class="p">))</span>
<a id="__codelineno-0-360" name="__codelineno-0-360"></a>        <span class="n">summary</span><span class="p">[</span><span class="s2">&quot;figures&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">get_regression_plots</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_metric_specs</span><span class="p">))</span>
<a id="__codelineno-0-361" name="__codelineno-0-361"></a>        <span class="k">return</span> <span class="n">summary</span>
<a id="__codelineno-0-362" name="__codelineno-0-362"></a>
<a id="__codelineno-0-363" name="__codelineno-0-363"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">__validate_metric_specs</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-0-364" name="__codelineno-0-364"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Check that the metric specs do not contain duplicate entries.&quot;&quot;&quot;</span>
<a id="__codelineno-0-365" name="__codelineno-0-365"></a>        <span class="n">seen_ids</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
<a id="__codelineno-0-366" name="__codelineno-0-366"></a>        <span class="k">for</span> <span class="n">spec</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_metric_specs</span><span class="p">:</span>
<a id="__codelineno-0-367" name="__codelineno-0-367"></a>            <span class="k">if</span> <span class="n">spec</span><span class="o">.</span><span class="n">id</span> <span class="ow">in</span> <span class="n">seen_ids</span><span class="p">:</span>
<a id="__codelineno-0-368" name="__codelineno-0-368"></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Duplicate MetricSpec id found: </span><span class="si">{</span><span class="n">spec</span><span class="o">.</span><span class="n">id</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-369" name="__codelineno-0-369"></a>            <span class="n">seen_ids</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">spec</span><span class="o">.</span><span class="n">id</span><span class="p">)</span>
<a id="__codelineno-0-370" name="__codelineno-0-370"></a>
<a id="__codelineno-0-371" name="__codelineno-0-371"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">__validate_common_inputs</span><span class="p">(</span>
<a id="__codelineno-0-372" name="__codelineno-0-372"></a>        <span class="bp">self</span><span class="p">,</span> <span class="n">y_true</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">column_names</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span> <span class="o">|</span> <span class="nb">int</span><span class="p">]</span>
<a id="__codelineno-0-373" name="__codelineno-0-373"></a>    <span class="p">):</span>
<a id="__codelineno-0-374" name="__codelineno-0-374"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Validate common inputs for both PROB and LABEL evaluations.&quot;&quot;&quot;</span>
<a id="__codelineno-0-375" name="__codelineno-0-375"></a>        <span class="c1"># Dimension checks - must be 2D</span>
<a id="__codelineno-0-376" name="__codelineno-0-376"></a>        <span class="k">if</span> <span class="n">y_true</span><span class="o">.</span><span class="n">ndim</span> <span class="o">!=</span> <span class="mi">2</span><span class="p">:</span>
<a id="__codelineno-0-377" name="__codelineno-0-377"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-378" name="__codelineno-0-378"></a>                <span class="sa">f</span><span class="s2">&quot;y_true must be a 2D array with shape (n_samples, n_classes). &quot;</span>
<a id="__codelineno-0-379" name="__codelineno-0-379"></a>                <span class="sa">f</span><span class="s2">&quot;Got shape: </span><span class="si">{</span><span class="n">y_true</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span>
<a id="__codelineno-0-380" name="__codelineno-0-380"></a>            <span class="p">)</span>
<a id="__codelineno-0-381" name="__codelineno-0-381"></a>        <span class="k">if</span> <span class="n">y_pred</span><span class="o">.</span><span class="n">ndim</span> <span class="o">!=</span> <span class="mi">2</span><span class="p">:</span>
<a id="__codelineno-0-382" name="__codelineno-0-382"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-383" name="__codelineno-0-383"></a>                <span class="sa">f</span><span class="s2">&quot;y_pred must be a 2D array with shape (n_samples, n_classes). &quot;</span>
<a id="__codelineno-0-384" name="__codelineno-0-384"></a>                <span class="sa">f</span><span class="s2">&quot;Got shape: </span><span class="si">{</span><span class="n">y_pred</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span>
<a id="__codelineno-0-385" name="__codelineno-0-385"></a>            <span class="p">)</span>
<a id="__codelineno-0-386" name="__codelineno-0-386"></a>        <span class="c1"># Shape checks - must match</span>
<a id="__codelineno-0-387" name="__codelineno-0-387"></a>        <span class="k">if</span> <span class="n">y_true</span><span class="o">.</span><span class="n">shape</span> <span class="o">!=</span> <span class="n">y_pred</span><span class="o">.</span><span class="n">shape</span><span class="p">:</span>
<a id="__codelineno-0-388" name="__codelineno-0-388"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-389" name="__codelineno-0-389"></a>                <span class="sa">f</span><span class="s2">&quot;y_true and y_pred must have the same shape. &quot;</span>
<a id="__codelineno-0-390" name="__codelineno-0-390"></a>                <span class="sa">f</span><span class="s2">&quot;Got y_true: </span><span class="si">{</span><span class="n">y_true</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">, y_pred: </span><span class="si">{</span><span class="n">y_pred</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span>
<a id="__codelineno-0-391" name="__codelineno-0-391"></a>            <span class="p">)</span>
<a id="__codelineno-0-392" name="__codelineno-0-392"></a>
<a id="__codelineno-0-393" name="__codelineno-0-393"></a>        <span class="c1"># Column names check</span>
<a id="__codelineno-0-394" name="__codelineno-0-394"></a>        <span class="n">n_columns</span> <span class="o">=</span> <span class="n">y_pred</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<a id="__codelineno-0-395" name="__codelineno-0-395"></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">column_names</span><span class="p">)</span> <span class="o">!=</span> <span class="n">n_columns</span><span class="p">:</span>
<a id="__codelineno-0-396" name="__codelineno-0-396"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-397" name="__codelineno-0-397"></a>                <span class="sa">f</span><span class="s2">&quot;column_names length must match number of columns in y_pred. &quot;</span>
<a id="__codelineno-0-398" name="__codelineno-0-398"></a>                <span class="sa">f</span><span class="s2">&quot;Got column_names: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">column_names</span><span class="p">)</span><span class="si">}</span><span class="s2">, y_pred columns: </span><span class="si">{</span><span class="n">n_columns</span><span class="si">}</span><span class="s2">&quot;</span>
<a id="__codelineno-0-399" name="__codelineno-0-399"></a>            <span class="p">)</span>
<a id="__codelineno-0-400" name="__codelineno-0-400"></a>
<a id="__codelineno-0-401" name="__codelineno-0-401"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">__get_model_classes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span> <span class="o">|</span> <span class="nb">int</span><span class="p">]:</span>
<a id="__codelineno-0-402" name="__codelineno-0-402"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Get class labels from the model if available.</span>
<a id="__codelineno-0-403" name="__codelineno-0-403"></a>
<a id="__codelineno-0-404" name="__codelineno-0-404"></a><span class="sd">        Returns</span>
<a id="__codelineno-0-405" name="__codelineno-0-405"></a><span class="sd">        -------</span>
<a id="__codelineno-0-406" name="__codelineno-0-406"></a><span class="sd">        List[str | int]</span>
<a id="__codelineno-0-407" name="__codelineno-0-407"></a><span class="sd">            List of class labels.</span>
<a id="__codelineno-0-408" name="__codelineno-0-408"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-409" name="__codelineno-0-409"></a>
<a id="__codelineno-0-410" name="__codelineno-0-410"></a>        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="s2">&quot;classes_&quot;</span><span class="p">):</span>
<a id="__codelineno-0-411" name="__codelineno-0-411"></a>            <span class="n">classes</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">classes_</span>
<a id="__codelineno-0-412" name="__codelineno-0-412"></a>        <span class="k">elif</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="s2">&quot;classes&quot;</span><span class="p">):</span>
<a id="__codelineno-0-413" name="__codelineno-0-413"></a>            <span class="n">classes</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">classes</span>
<a id="__codelineno-0-414" name="__codelineno-0-414"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-415" name="__codelineno-0-415"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-416" name="__codelineno-0-416"></a>                <span class="s2">&quot;Model does not have &#39;classes&#39; or &#39;classes_&#39; attribute required for some metrics.&quot;</span>
<a id="__codelineno-0-417" name="__codelineno-0-417"></a>            <span class="p">)</span>
<a id="__codelineno-0-418" name="__codelineno-0-418"></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">classes</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
<a id="__codelineno-0-419" name="__codelineno-0-419"></a>            <span class="k">return</span> <span class="n">classes</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
<a id="__codelineno-0-420" name="__codelineno-0-420"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-421" name="__codelineno-0-421"></a>            <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="n">classes</span><span class="p">)</span>
<a id="__codelineno-0-422" name="__codelineno-0-422"></a>
<a id="__codelineno-0-423" name="__codelineno-0-423"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">__get_prob_specs</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">MetricSpec</span><span class="p">]:</span>
<a id="__codelineno-0-424" name="__codelineno-0-424"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the list of metric IDs that require probabilities.</span>
<a id="__codelineno-0-425" name="__codelineno-0-425"></a>
<a id="__codelineno-0-426" name="__codelineno-0-426"></a><span class="sd">        Returns</span>
<a id="__codelineno-0-427" name="__codelineno-0-427"></a><span class="sd">        -------</span>
<a id="__codelineno-0-428" name="__codelineno-0-428"></a><span class="sd">        List[str]</span>
<a id="__codelineno-0-429" name="__codelineno-0-429"></a><span class="sd">            List of metric IDs requiring probabilities.</span>
<a id="__codelineno-0-430" name="__codelineno-0-430"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-431" name="__codelineno-0-431"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__find_specs_by_type</span><span class="p">(</span><span class="n">MetricTypeEnum</span><span class="o">.</span><span class="n">PROBS</span><span class="p">)</span>
<a id="__codelineno-0-432" name="__codelineno-0-432"></a>
<a id="__codelineno-0-433" name="__codelineno-0-433"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">__get_label_specs</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">MetricSpec</span><span class="p">]:</span>
<a id="__codelineno-0-434" name="__codelineno-0-434"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the list of metric IDs that require labels.</span>
<a id="__codelineno-0-435" name="__codelineno-0-435"></a>
<a id="__codelineno-0-436" name="__codelineno-0-436"></a><span class="sd">        Returns</span>
<a id="__codelineno-0-437" name="__codelineno-0-437"></a><span class="sd">        -------</span>
<a id="__codelineno-0-438" name="__codelineno-0-438"></a><span class="sd">        List[str]</span>
<a id="__codelineno-0-439" name="__codelineno-0-439"></a><span class="sd">            List of metric IDs requiring labels.</span>
<a id="__codelineno-0-440" name="__codelineno-0-440"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-441" name="__codelineno-0-441"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__find_specs_by_type</span><span class="p">(</span><span class="n">MetricTypeEnum</span><span class="o">.</span><span class="n">LABELS</span><span class="p">)</span>
<a id="__codelineno-0-442" name="__codelineno-0-442"></a>
<a id="__codelineno-0-443" name="__codelineno-0-443"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">__get_regression_specs</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">MetricSpec</span><span class="p">]:</span>
<a id="__codelineno-0-444" name="__codelineno-0-444"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the list of metric IDs that require regression outputs.</span>
<a id="__codelineno-0-445" name="__codelineno-0-445"></a>
<a id="__codelineno-0-446" name="__codelineno-0-446"></a><span class="sd">        Returns</span>
<a id="__codelineno-0-447" name="__codelineno-0-447"></a><span class="sd">        -------</span>
<a id="__codelineno-0-448" name="__codelineno-0-448"></a><span class="sd">        List[str]</span>
<a id="__codelineno-0-449" name="__codelineno-0-449"></a><span class="sd">            List of metric IDs requiring regression outputs.</span>
<a id="__codelineno-0-450" name="__codelineno-0-450"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-451" name="__codelineno-0-451"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__find_specs_by_type</span><span class="p">(</span><span class="n">MetricTypeEnum</span><span class="o">.</span><span class="n">SCORES</span><span class="p">)</span>
<a id="__codelineno-0-452" name="__codelineno-0-452"></a>
<a id="__codelineno-0-453" name="__codelineno-0-453"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">__find_specs_by_type</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">metric_type</span><span class="p">:</span> <span class="n">MetricTypeEnum</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">MetricSpec</span><span class="p">]:</span>
<a id="__codelineno-0-454" name="__codelineno-0-454"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Find all MetricSpecs of a given type.</span>
<a id="__codelineno-0-455" name="__codelineno-0-455"></a>
<a id="__codelineno-0-456" name="__codelineno-0-456"></a><span class="sd">        Parameters</span>
<a id="__codelineno-0-457" name="__codelineno-0-457"></a><span class="sd">        ----------</span>
<a id="__codelineno-0-458" name="__codelineno-0-458"></a><span class="sd">        metric_type : MetricTypeEnum</span>
<a id="__codelineno-0-459" name="__codelineno-0-459"></a><span class="sd">            The type of metrics to find.</span>
<a id="__codelineno-0-460" name="__codelineno-0-460"></a>
<a id="__codelineno-0-461" name="__codelineno-0-461"></a><span class="sd">        Returns</span>
<a id="__codelineno-0-462" name="__codelineno-0-462"></a><span class="sd">        -------</span>
<a id="__codelineno-0-463" name="__codelineno-0-463"></a><span class="sd">        List[MetricSpec]</span>
<a id="__codelineno-0-464" name="__codelineno-0-464"></a><span class="sd">            List of MetricSpecs matching the given type.</span>
<a id="__codelineno-0-465" name="__codelineno-0-465"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-466" name="__codelineno-0-466"></a>        <span class="k">return</span> <span class="p">[</span><span class="n">spec</span> <span class="k">for</span> <span class="n">spec</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_metric_specs</span> <span class="k">if</span> <span class="n">spec</span><span class="o">.</span><span class="n">metric</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="n">metric_type</span><span class="p">]</span>
</code></pre></div></td></tr></table></div>
              </details>



<div class="doc doc-children">










<div class="doc doc-object doc-function">


<h3 id="metrics_toolbox.evaluator.MetricEvaluator.__find_specs_by_type" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">__find_specs_by_type</span><span class="p">(</span><span class="n">metric_type</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Find all MetricSpecs of a given type.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>metric_type</code></b>
                  (<code><a class="autorefs autorefs-internal" title="MetricTypeEnum (metrics_toolbox.metrics.enums.MetricTypeEnum)" href="../metrics/enums/#metrics_toolbox.metrics.enums.MetricTypeEnum">MetricTypeEnum</a></code>)
              
              <div class="doc-md-description">
                <p>The type of metrics to find.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Returns:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
                  <code><span title="typing.List">List</span>[<a class="autorefs autorefs-internal" title="MetricSpec (metrics_toolbox.spec.MetricSpec)" href="../spec/#metrics_toolbox.spec.MetricSpec">MetricSpec</a>]</code>
              
              <div class="doc-md-description">
                <p>List of MetricSpecs matching the given type.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

            <details class="mkdocstrings-source">
              <summary>Source code in <code>metrics_toolbox/evaluator.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-453">453</a></span>
<span class="normal"><a href="#__codelineno-0-454">454</a></span>
<span class="normal"><a href="#__codelineno-0-455">455</a></span>
<span class="normal"><a href="#__codelineno-0-456">456</a></span>
<span class="normal"><a href="#__codelineno-0-457">457</a></span>
<span class="normal"><a href="#__codelineno-0-458">458</a></span>
<span class="normal"><a href="#__codelineno-0-459">459</a></span>
<span class="normal"><a href="#__codelineno-0-460">460</a></span>
<span class="normal"><a href="#__codelineno-0-461">461</a></span>
<span class="normal"><a href="#__codelineno-0-462">462</a></span>
<span class="normal"><a href="#__codelineno-0-463">463</a></span>
<span class="normal"><a href="#__codelineno-0-464">464</a></span>
<span class="normal"><a href="#__codelineno-0-465">465</a></span>
<span class="normal"><a href="#__codelineno-0-466">466</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-453" name="__codelineno-0-453"></a><span class="k">def</span><span class="w"> </span><span class="nf">__find_specs_by_type</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">metric_type</span><span class="p">:</span> <span class="n">MetricTypeEnum</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">MetricSpec</span><span class="p">]:</span>
<a id="__codelineno-0-454" name="__codelineno-0-454"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Find all MetricSpecs of a given type.</span>
<a id="__codelineno-0-455" name="__codelineno-0-455"></a>
<a id="__codelineno-0-456" name="__codelineno-0-456"></a><span class="sd">    Parameters</span>
<a id="__codelineno-0-457" name="__codelineno-0-457"></a><span class="sd">    ----------</span>
<a id="__codelineno-0-458" name="__codelineno-0-458"></a><span class="sd">    metric_type : MetricTypeEnum</span>
<a id="__codelineno-0-459" name="__codelineno-0-459"></a><span class="sd">        The type of metrics to find.</span>
<a id="__codelineno-0-460" name="__codelineno-0-460"></a>
<a id="__codelineno-0-461" name="__codelineno-0-461"></a><span class="sd">    Returns</span>
<a id="__codelineno-0-462" name="__codelineno-0-462"></a><span class="sd">    -------</span>
<a id="__codelineno-0-463" name="__codelineno-0-463"></a><span class="sd">    List[MetricSpec]</span>
<a id="__codelineno-0-464" name="__codelineno-0-464"></a><span class="sd">        List of MetricSpecs matching the given type.</span>
<a id="__codelineno-0-465" name="__codelineno-0-465"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-466" name="__codelineno-0-466"></a>    <span class="k">return</span> <span class="p">[</span><span class="n">spec</span> <span class="k">for</span> <span class="n">spec</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_metric_specs</span> <span class="k">if</span> <span class="n">spec</span><span class="o">.</span><span class="n">metric</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="n">metric_type</span><span class="p">]</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="metrics_toolbox.evaluator.MetricEvaluator.__get_label_specs" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">__get_label_specs</span><span class="p">()</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Get the list of metric IDs that require labels.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Returns:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
                  <code><span title="typing.List">List</span>[<span title="str">str</span>]</code>
              
              <div class="doc-md-description">
                <p>List of metric IDs requiring labels.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

            <details class="mkdocstrings-source">
              <summary>Source code in <code>metrics_toolbox/evaluator.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-433">433</a></span>
<span class="normal"><a href="#__codelineno-0-434">434</a></span>
<span class="normal"><a href="#__codelineno-0-435">435</a></span>
<span class="normal"><a href="#__codelineno-0-436">436</a></span>
<span class="normal"><a href="#__codelineno-0-437">437</a></span>
<span class="normal"><a href="#__codelineno-0-438">438</a></span>
<span class="normal"><a href="#__codelineno-0-439">439</a></span>
<span class="normal"><a href="#__codelineno-0-440">440</a></span>
<span class="normal"><a href="#__codelineno-0-441">441</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-433" name="__codelineno-0-433"></a><span class="k">def</span><span class="w"> </span><span class="nf">__get_label_specs</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">MetricSpec</span><span class="p">]:</span>
<a id="__codelineno-0-434" name="__codelineno-0-434"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Get the list of metric IDs that require labels.</span>
<a id="__codelineno-0-435" name="__codelineno-0-435"></a>
<a id="__codelineno-0-436" name="__codelineno-0-436"></a><span class="sd">    Returns</span>
<a id="__codelineno-0-437" name="__codelineno-0-437"></a><span class="sd">    -------</span>
<a id="__codelineno-0-438" name="__codelineno-0-438"></a><span class="sd">    List[str]</span>
<a id="__codelineno-0-439" name="__codelineno-0-439"></a><span class="sd">        List of metric IDs requiring labels.</span>
<a id="__codelineno-0-440" name="__codelineno-0-440"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-441" name="__codelineno-0-441"></a>    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__find_specs_by_type</span><span class="p">(</span><span class="n">MetricTypeEnum</span><span class="o">.</span><span class="n">LABELS</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="metrics_toolbox.evaluator.MetricEvaluator.__get_model_classes" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">__get_model_classes</span><span class="p">(</span><span class="n">model</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Get class labels from the model if available.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Returns:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
                  <code><span title="typing.List">List</span>[<span title="str">str</span> | <span title="int">int</span>]</code>
              
              <div class="doc-md-description">
                <p>List of class labels.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

            <details class="mkdocstrings-source">
              <summary>Source code in <code>metrics_toolbox/evaluator.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-401">401</a></span>
<span class="normal"><a href="#__codelineno-0-402">402</a></span>
<span class="normal"><a href="#__codelineno-0-403">403</a></span>
<span class="normal"><a href="#__codelineno-0-404">404</a></span>
<span class="normal"><a href="#__codelineno-0-405">405</a></span>
<span class="normal"><a href="#__codelineno-0-406">406</a></span>
<span class="normal"><a href="#__codelineno-0-407">407</a></span>
<span class="normal"><a href="#__codelineno-0-408">408</a></span>
<span class="normal"><a href="#__codelineno-0-409">409</a></span>
<span class="normal"><a href="#__codelineno-0-410">410</a></span>
<span class="normal"><a href="#__codelineno-0-411">411</a></span>
<span class="normal"><a href="#__codelineno-0-412">412</a></span>
<span class="normal"><a href="#__codelineno-0-413">413</a></span>
<span class="normal"><a href="#__codelineno-0-414">414</a></span>
<span class="normal"><a href="#__codelineno-0-415">415</a></span>
<span class="normal"><a href="#__codelineno-0-416">416</a></span>
<span class="normal"><a href="#__codelineno-0-417">417</a></span>
<span class="normal"><a href="#__codelineno-0-418">418</a></span>
<span class="normal"><a href="#__codelineno-0-419">419</a></span>
<span class="normal"><a href="#__codelineno-0-420">420</a></span>
<span class="normal"><a href="#__codelineno-0-421">421</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-401" name="__codelineno-0-401"></a><span class="k">def</span><span class="w"> </span><span class="nf">__get_model_classes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span> <span class="o">|</span> <span class="nb">int</span><span class="p">]:</span>
<a id="__codelineno-0-402" name="__codelineno-0-402"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Get class labels from the model if available.</span>
<a id="__codelineno-0-403" name="__codelineno-0-403"></a>
<a id="__codelineno-0-404" name="__codelineno-0-404"></a><span class="sd">    Returns</span>
<a id="__codelineno-0-405" name="__codelineno-0-405"></a><span class="sd">    -------</span>
<a id="__codelineno-0-406" name="__codelineno-0-406"></a><span class="sd">    List[str | int]</span>
<a id="__codelineno-0-407" name="__codelineno-0-407"></a><span class="sd">        List of class labels.</span>
<a id="__codelineno-0-408" name="__codelineno-0-408"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-409" name="__codelineno-0-409"></a>
<a id="__codelineno-0-410" name="__codelineno-0-410"></a>    <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="s2">&quot;classes_&quot;</span><span class="p">):</span>
<a id="__codelineno-0-411" name="__codelineno-0-411"></a>        <span class="n">classes</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">classes_</span>
<a id="__codelineno-0-412" name="__codelineno-0-412"></a>    <span class="k">elif</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="s2">&quot;classes&quot;</span><span class="p">):</span>
<a id="__codelineno-0-413" name="__codelineno-0-413"></a>        <span class="n">classes</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">classes</span>
<a id="__codelineno-0-414" name="__codelineno-0-414"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-415" name="__codelineno-0-415"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-416" name="__codelineno-0-416"></a>            <span class="s2">&quot;Model does not have &#39;classes&#39; or &#39;classes_&#39; attribute required for some metrics.&quot;</span>
<a id="__codelineno-0-417" name="__codelineno-0-417"></a>        <span class="p">)</span>
<a id="__codelineno-0-418" name="__codelineno-0-418"></a>    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">classes</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
<a id="__codelineno-0-419" name="__codelineno-0-419"></a>        <span class="k">return</span> <span class="n">classes</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
<a id="__codelineno-0-420" name="__codelineno-0-420"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-421" name="__codelineno-0-421"></a>        <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="n">classes</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="metrics_toolbox.evaluator.MetricEvaluator.__get_prob_specs" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">__get_prob_specs</span><span class="p">()</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Get the list of metric IDs that require probabilities.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Returns:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
                  <code><span title="typing.List">List</span>[<span title="str">str</span>]</code>
              
              <div class="doc-md-description">
                <p>List of metric IDs requiring probabilities.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

            <details class="mkdocstrings-source">
              <summary>Source code in <code>metrics_toolbox/evaluator.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-423">423</a></span>
<span class="normal"><a href="#__codelineno-0-424">424</a></span>
<span class="normal"><a href="#__codelineno-0-425">425</a></span>
<span class="normal"><a href="#__codelineno-0-426">426</a></span>
<span class="normal"><a href="#__codelineno-0-427">427</a></span>
<span class="normal"><a href="#__codelineno-0-428">428</a></span>
<span class="normal"><a href="#__codelineno-0-429">429</a></span>
<span class="normal"><a href="#__codelineno-0-430">430</a></span>
<span class="normal"><a href="#__codelineno-0-431">431</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-423" name="__codelineno-0-423"></a><span class="k">def</span><span class="w"> </span><span class="nf">__get_prob_specs</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">MetricSpec</span><span class="p">]:</span>
<a id="__codelineno-0-424" name="__codelineno-0-424"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Get the list of metric IDs that require probabilities.</span>
<a id="__codelineno-0-425" name="__codelineno-0-425"></a>
<a id="__codelineno-0-426" name="__codelineno-0-426"></a><span class="sd">    Returns</span>
<a id="__codelineno-0-427" name="__codelineno-0-427"></a><span class="sd">    -------</span>
<a id="__codelineno-0-428" name="__codelineno-0-428"></a><span class="sd">    List[str]</span>
<a id="__codelineno-0-429" name="__codelineno-0-429"></a><span class="sd">        List of metric IDs requiring probabilities.</span>
<a id="__codelineno-0-430" name="__codelineno-0-430"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-431" name="__codelineno-0-431"></a>    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__find_specs_by_type</span><span class="p">(</span><span class="n">MetricTypeEnum</span><span class="o">.</span><span class="n">PROBS</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="metrics_toolbox.evaluator.MetricEvaluator.__get_regression_specs" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">__get_regression_specs</span><span class="p">()</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Get the list of metric IDs that require regression outputs.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Returns:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
                  <code><span title="typing.List">List</span>[<span title="str">str</span>]</code>
              
              <div class="doc-md-description">
                <p>List of metric IDs requiring regression outputs.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

            <details class="mkdocstrings-source">
              <summary>Source code in <code>metrics_toolbox/evaluator.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-443">443</a></span>
<span class="normal"><a href="#__codelineno-0-444">444</a></span>
<span class="normal"><a href="#__codelineno-0-445">445</a></span>
<span class="normal"><a href="#__codelineno-0-446">446</a></span>
<span class="normal"><a href="#__codelineno-0-447">447</a></span>
<span class="normal"><a href="#__codelineno-0-448">448</a></span>
<span class="normal"><a href="#__codelineno-0-449">449</a></span>
<span class="normal"><a href="#__codelineno-0-450">450</a></span>
<span class="normal"><a href="#__codelineno-0-451">451</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-443" name="__codelineno-0-443"></a><span class="k">def</span><span class="w"> </span><span class="nf">__get_regression_specs</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">MetricSpec</span><span class="p">]:</span>
<a id="__codelineno-0-444" name="__codelineno-0-444"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Get the list of metric IDs that require regression outputs.</span>
<a id="__codelineno-0-445" name="__codelineno-0-445"></a>
<a id="__codelineno-0-446" name="__codelineno-0-446"></a><span class="sd">    Returns</span>
<a id="__codelineno-0-447" name="__codelineno-0-447"></a><span class="sd">    -------</span>
<a id="__codelineno-0-448" name="__codelineno-0-448"></a><span class="sd">    List[str]</span>
<a id="__codelineno-0-449" name="__codelineno-0-449"></a><span class="sd">        List of metric IDs requiring regression outputs.</span>
<a id="__codelineno-0-450" name="__codelineno-0-450"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-451" name="__codelineno-0-451"></a>    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__find_specs_by_type</span><span class="p">(</span><span class="n">MetricTypeEnum</span><span class="o">.</span><span class="n">SCORES</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="metrics_toolbox.evaluator.MetricEvaluator.__init__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">metric_specs</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Initialize the MetricEvaluator with a list of MetricSpecs.</p>
<p>Duplicate MetricSpecs (same metric, scope, and class_name) are not allowed,
and will raise a ValueError.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>metric_specs</code></b>
                  (<code><span title="list">list</span>[<a class="autorefs autorefs-internal" title="MetricSpec (metrics_toolbox.spec.MetricSpec)" href="../spec/#metrics_toolbox.spec.MetricSpec">MetricSpec</a>]</code>)
              
              <div class="doc-md-description">
                <p>A list of MetricSpec instances defining the metrics to evaluate.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

            <details class="mkdocstrings-source">
              <summary>Source code in <code>metrics_toolbox/evaluator.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-43">43</a></span>
<span class="normal"><a href="#__codelineno-0-44">44</a></span>
<span class="normal"><a href="#__codelineno-0-45">45</a></span>
<span class="normal"><a href="#__codelineno-0-46">46</a></span>
<span class="normal"><a href="#__codelineno-0-47">47</a></span>
<span class="normal"><a href="#__codelineno-0-48">48</a></span>
<span class="normal"><a href="#__codelineno-0-49">49</a></span>
<span class="normal"><a href="#__codelineno-0-50">50</a></span>
<span class="normal"><a href="#__codelineno-0-51">51</a></span>
<span class="normal"><a href="#__codelineno-0-52">52</a></span>
<span class="normal"><a href="#__codelineno-0-53">53</a></span>
<span class="normal"><a href="#__codelineno-0-54">54</a></span>
<span class="normal"><a href="#__codelineno-0-55">55</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-43" name="__codelineno-0-43"></a><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">metric_specs</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">MetricSpec</span><span class="p">]):</span>
<a id="__codelineno-0-44" name="__codelineno-0-44"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Initialize the MetricEvaluator with a list of MetricSpecs.</span>
<a id="__codelineno-0-45" name="__codelineno-0-45"></a>
<a id="__codelineno-0-46" name="__codelineno-0-46"></a><span class="sd">    Duplicate MetricSpecs (same metric, scope, and class_name) are not allowed,</span>
<a id="__codelineno-0-47" name="__codelineno-0-47"></a><span class="sd">    and will raise a ValueError.</span>
<a id="__codelineno-0-48" name="__codelineno-0-48"></a>
<a id="__codelineno-0-49" name="__codelineno-0-49"></a><span class="sd">    Parameters</span>
<a id="__codelineno-0-50" name="__codelineno-0-50"></a><span class="sd">    ----------</span>
<a id="__codelineno-0-51" name="__codelineno-0-51"></a><span class="sd">    metric_specs : list[MetricSpec]</span>
<a id="__codelineno-0-52" name="__codelineno-0-52"></a><span class="sd">        A list of MetricSpec instances defining the metrics to evaluate.</span>
<a id="__codelineno-0-53" name="__codelineno-0-53"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-54" name="__codelineno-0-54"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_metric_specs</span> <span class="o">=</span> <span class="n">metric_specs</span>
<a id="__codelineno-0-55" name="__codelineno-0-55"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">__validate_metric_specs</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="metrics_toolbox.evaluator.MetricEvaluator.__validate_common_inputs" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">__validate_common_inputs</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">column_names</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Validate common inputs for both PROB and LABEL evaluations.</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>metrics_toolbox/evaluator.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-371">371</a></span>
<span class="normal"><a href="#__codelineno-0-372">372</a></span>
<span class="normal"><a href="#__codelineno-0-373">373</a></span>
<span class="normal"><a href="#__codelineno-0-374">374</a></span>
<span class="normal"><a href="#__codelineno-0-375">375</a></span>
<span class="normal"><a href="#__codelineno-0-376">376</a></span>
<span class="normal"><a href="#__codelineno-0-377">377</a></span>
<span class="normal"><a href="#__codelineno-0-378">378</a></span>
<span class="normal"><a href="#__codelineno-0-379">379</a></span>
<span class="normal"><a href="#__codelineno-0-380">380</a></span>
<span class="normal"><a href="#__codelineno-0-381">381</a></span>
<span class="normal"><a href="#__codelineno-0-382">382</a></span>
<span class="normal"><a href="#__codelineno-0-383">383</a></span>
<span class="normal"><a href="#__codelineno-0-384">384</a></span>
<span class="normal"><a href="#__codelineno-0-385">385</a></span>
<span class="normal"><a href="#__codelineno-0-386">386</a></span>
<span class="normal"><a href="#__codelineno-0-387">387</a></span>
<span class="normal"><a href="#__codelineno-0-388">388</a></span>
<span class="normal"><a href="#__codelineno-0-389">389</a></span>
<span class="normal"><a href="#__codelineno-0-390">390</a></span>
<span class="normal"><a href="#__codelineno-0-391">391</a></span>
<span class="normal"><a href="#__codelineno-0-392">392</a></span>
<span class="normal"><a href="#__codelineno-0-393">393</a></span>
<span class="normal"><a href="#__codelineno-0-394">394</a></span>
<span class="normal"><a href="#__codelineno-0-395">395</a></span>
<span class="normal"><a href="#__codelineno-0-396">396</a></span>
<span class="normal"><a href="#__codelineno-0-397">397</a></span>
<span class="normal"><a href="#__codelineno-0-398">398</a></span>
<span class="normal"><a href="#__codelineno-0-399">399</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-371" name="__codelineno-0-371"></a><span class="k">def</span><span class="w"> </span><span class="nf">__validate_common_inputs</span><span class="p">(</span>
<a id="__codelineno-0-372" name="__codelineno-0-372"></a>    <span class="bp">self</span><span class="p">,</span> <span class="n">y_true</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">column_names</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span> <span class="o">|</span> <span class="nb">int</span><span class="p">]</span>
<a id="__codelineno-0-373" name="__codelineno-0-373"></a><span class="p">):</span>
<a id="__codelineno-0-374" name="__codelineno-0-374"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Validate common inputs for both PROB and LABEL evaluations.&quot;&quot;&quot;</span>
<a id="__codelineno-0-375" name="__codelineno-0-375"></a>    <span class="c1"># Dimension checks - must be 2D</span>
<a id="__codelineno-0-376" name="__codelineno-0-376"></a>    <span class="k">if</span> <span class="n">y_true</span><span class="o">.</span><span class="n">ndim</span> <span class="o">!=</span> <span class="mi">2</span><span class="p">:</span>
<a id="__codelineno-0-377" name="__codelineno-0-377"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-378" name="__codelineno-0-378"></a>            <span class="sa">f</span><span class="s2">&quot;y_true must be a 2D array with shape (n_samples, n_classes). &quot;</span>
<a id="__codelineno-0-379" name="__codelineno-0-379"></a>            <span class="sa">f</span><span class="s2">&quot;Got shape: </span><span class="si">{</span><span class="n">y_true</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span>
<a id="__codelineno-0-380" name="__codelineno-0-380"></a>        <span class="p">)</span>
<a id="__codelineno-0-381" name="__codelineno-0-381"></a>    <span class="k">if</span> <span class="n">y_pred</span><span class="o">.</span><span class="n">ndim</span> <span class="o">!=</span> <span class="mi">2</span><span class="p">:</span>
<a id="__codelineno-0-382" name="__codelineno-0-382"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-383" name="__codelineno-0-383"></a>            <span class="sa">f</span><span class="s2">&quot;y_pred must be a 2D array with shape (n_samples, n_classes). &quot;</span>
<a id="__codelineno-0-384" name="__codelineno-0-384"></a>            <span class="sa">f</span><span class="s2">&quot;Got shape: </span><span class="si">{</span><span class="n">y_pred</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span>
<a id="__codelineno-0-385" name="__codelineno-0-385"></a>        <span class="p">)</span>
<a id="__codelineno-0-386" name="__codelineno-0-386"></a>    <span class="c1"># Shape checks - must match</span>
<a id="__codelineno-0-387" name="__codelineno-0-387"></a>    <span class="k">if</span> <span class="n">y_true</span><span class="o">.</span><span class="n">shape</span> <span class="o">!=</span> <span class="n">y_pred</span><span class="o">.</span><span class="n">shape</span><span class="p">:</span>
<a id="__codelineno-0-388" name="__codelineno-0-388"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-389" name="__codelineno-0-389"></a>            <span class="sa">f</span><span class="s2">&quot;y_true and y_pred must have the same shape. &quot;</span>
<a id="__codelineno-0-390" name="__codelineno-0-390"></a>            <span class="sa">f</span><span class="s2">&quot;Got y_true: </span><span class="si">{</span><span class="n">y_true</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">, y_pred: </span><span class="si">{</span><span class="n">y_pred</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span>
<a id="__codelineno-0-391" name="__codelineno-0-391"></a>        <span class="p">)</span>
<a id="__codelineno-0-392" name="__codelineno-0-392"></a>
<a id="__codelineno-0-393" name="__codelineno-0-393"></a>    <span class="c1"># Column names check</span>
<a id="__codelineno-0-394" name="__codelineno-0-394"></a>    <span class="n">n_columns</span> <span class="o">=</span> <span class="n">y_pred</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<a id="__codelineno-0-395" name="__codelineno-0-395"></a>    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">column_names</span><span class="p">)</span> <span class="o">!=</span> <span class="n">n_columns</span><span class="p">:</span>
<a id="__codelineno-0-396" name="__codelineno-0-396"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-397" name="__codelineno-0-397"></a>            <span class="sa">f</span><span class="s2">&quot;column_names length must match number of columns in y_pred. &quot;</span>
<a id="__codelineno-0-398" name="__codelineno-0-398"></a>            <span class="sa">f</span><span class="s2">&quot;Got column_names: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">column_names</span><span class="p">)</span><span class="si">}</span><span class="s2">, y_pred columns: </span><span class="si">{</span><span class="n">n_columns</span><span class="si">}</span><span class="s2">&quot;</span>
<a id="__codelineno-0-399" name="__codelineno-0-399"></a>        <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="metrics_toolbox.evaluator.MetricEvaluator.__validate_metric_specs" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">__validate_metric_specs</span><span class="p">()</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Check that the metric specs do not contain duplicate entries.</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>metrics_toolbox/evaluator.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-363">363</a></span>
<span class="normal"><a href="#__codelineno-0-364">364</a></span>
<span class="normal"><a href="#__codelineno-0-365">365</a></span>
<span class="normal"><a href="#__codelineno-0-366">366</a></span>
<span class="normal"><a href="#__codelineno-0-367">367</a></span>
<span class="normal"><a href="#__codelineno-0-368">368</a></span>
<span class="normal"><a href="#__codelineno-0-369">369</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-363" name="__codelineno-0-363"></a><span class="k">def</span><span class="w"> </span><span class="nf">__validate_metric_specs</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-0-364" name="__codelineno-0-364"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Check that the metric specs do not contain duplicate entries.&quot;&quot;&quot;</span>
<a id="__codelineno-0-365" name="__codelineno-0-365"></a>    <span class="n">seen_ids</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
<a id="__codelineno-0-366" name="__codelineno-0-366"></a>    <span class="k">for</span> <span class="n">spec</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_metric_specs</span><span class="p">:</span>
<a id="__codelineno-0-367" name="__codelineno-0-367"></a>        <span class="k">if</span> <span class="n">spec</span><span class="o">.</span><span class="n">id</span> <span class="ow">in</span> <span class="n">seen_ids</span><span class="p">:</span>
<a id="__codelineno-0-368" name="__codelineno-0-368"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Duplicate MetricSpec id found: </span><span class="si">{</span><span class="n">spec</span><span class="o">.</span><span class="n">id</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-369" name="__codelineno-0-369"></a>        <span class="n">seen_ids</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">spec</span><span class="o">.</span><span class="n">id</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="metrics_toolbox.evaluator.MetricEvaluator.add_label_evaluation" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">add_label_evaluation</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">column_names</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Evaluate LABEL metrics and add new step to history.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>y_true</code></b>
                  (<code><span title="numpy.ndarray">ndarray</span></code>)
              
              <div class="doc-md-description">
                <p>True labels. Ints or strings.</p>
              </div>
            </li>
            <li>
              <b><code>y_pred</code></b>
                  (<code><span title="numpy.ndarray">ndarray</span></code>)
              
              <div class="doc-md-description">
                <p>Predicted labels. Ints or strings.</p>
              </div>
            </li>
            <li>
              <b><code>column_names</code></b>
                  (<code>(<span title="typing.List">List</span>[<span title="str">str</span> | <span title="int">int</span>],)</code>)
              
              <div class="doc-md-description">
                <p>The names of the columns/classes the input arrays correspond to.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

            <details class="mkdocstrings-source">
              <summary>Source code in <code>metrics_toolbox/evaluator.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-114">114</a></span>
<span class="normal"><a href="#__codelineno-0-115">115</a></span>
<span class="normal"><a href="#__codelineno-0-116">116</a></span>
<span class="normal"><a href="#__codelineno-0-117">117</a></span>
<span class="normal"><a href="#__codelineno-0-118">118</a></span>
<span class="normal"><a href="#__codelineno-0-119">119</a></span>
<span class="normal"><a href="#__codelineno-0-120">120</a></span>
<span class="normal"><a href="#__codelineno-0-121">121</a></span>
<span class="normal"><a href="#__codelineno-0-122">122</a></span>
<span class="normal"><a href="#__codelineno-0-123">123</a></span>
<span class="normal"><a href="#__codelineno-0-124">124</a></span>
<span class="normal"><a href="#__codelineno-0-125">125</a></span>
<span class="normal"><a href="#__codelineno-0-126">126</a></span>
<span class="normal"><a href="#__codelineno-0-127">127</a></span>
<span class="normal"><a href="#__codelineno-0-128">128</a></span>
<span class="normal"><a href="#__codelineno-0-129">129</a></span>
<span class="normal"><a href="#__codelineno-0-130">130</a></span>
<span class="normal"><a href="#__codelineno-0-131">131</a></span>
<span class="normal"><a href="#__codelineno-0-132">132</a></span>
<span class="normal"><a href="#__codelineno-0-133">133</a></span>
<span class="normal"><a href="#__codelineno-0-134">134</a></span>
<span class="normal"><a href="#__codelineno-0-135">135</a></span>
<span class="normal"><a href="#__codelineno-0-136">136</a></span>
<span class="normal"><a href="#__codelineno-0-137">137</a></span>
<span class="normal"><a href="#__codelineno-0-138">138</a></span>
<span class="normal"><a href="#__codelineno-0-139">139</a></span>
<span class="normal"><a href="#__codelineno-0-140">140</a></span>
<span class="normal"><a href="#__codelineno-0-141">141</a></span>
<span class="normal"><a href="#__codelineno-0-142">142</a></span>
<span class="normal"><a href="#__codelineno-0-143">143</a></span>
<span class="normal"><a href="#__codelineno-0-144">144</a></span>
<span class="normal"><a href="#__codelineno-0-145">145</a></span>
<span class="normal"><a href="#__codelineno-0-146">146</a></span>
<span class="normal"><a href="#__codelineno-0-147">147</a></span>
<span class="normal"><a href="#__codelineno-0-148">148</a></span>
<span class="normal"><a href="#__codelineno-0-149">149</a></span>
<span class="normal"><a href="#__codelineno-0-150">150</a></span>
<span class="normal"><a href="#__codelineno-0-151">151</a></span>
<span class="normal"><a href="#__codelineno-0-152">152</a></span>
<span class="normal"><a href="#__codelineno-0-153">153</a></span>
<span class="normal"><a href="#__codelineno-0-154">154</a></span>
<span class="normal"><a href="#__codelineno-0-155">155</a></span>
<span class="normal"><a href="#__codelineno-0-156">156</a></span>
<span class="normal"><a href="#__codelineno-0-157">157</a></span>
<span class="normal"><a href="#__codelineno-0-158">158</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-114" name="__codelineno-0-114"></a><span class="k">def</span><span class="w"> </span><span class="nf">add_label_evaluation</span><span class="p">(</span>
<a id="__codelineno-0-115" name="__codelineno-0-115"></a>    <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-116" name="__codelineno-0-116"></a>    <span class="n">y_true</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
<a id="__codelineno-0-117" name="__codelineno-0-117"></a>    <span class="n">y_pred</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
<a id="__codelineno-0-118" name="__codelineno-0-118"></a>    <span class="n">column_names</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span> <span class="o">|</span> <span class="nb">int</span><span class="p">],</span>
<a id="__codelineno-0-119" name="__codelineno-0-119"></a><span class="p">):</span>
<a id="__codelineno-0-120" name="__codelineno-0-120"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Evaluate LABEL metrics and add new step to history.</span>
<a id="__codelineno-0-121" name="__codelineno-0-121"></a>
<a id="__codelineno-0-122" name="__codelineno-0-122"></a><span class="sd">    Parameters</span>
<a id="__codelineno-0-123" name="__codelineno-0-123"></a><span class="sd">    ----------</span>
<a id="__codelineno-0-124" name="__codelineno-0-124"></a><span class="sd">    y_true : np.ndarray</span>
<a id="__codelineno-0-125" name="__codelineno-0-125"></a><span class="sd">        True labels. Ints or strings.</span>
<a id="__codelineno-0-126" name="__codelineno-0-126"></a><span class="sd">    y_pred : np.ndarray</span>
<a id="__codelineno-0-127" name="__codelineno-0-127"></a><span class="sd">        Predicted labels. Ints or strings.</span>
<a id="__codelineno-0-128" name="__codelineno-0-128"></a><span class="sd">    column_names : List[str | int],</span>
<a id="__codelineno-0-129" name="__codelineno-0-129"></a><span class="sd">        The names of the columns/classes the input arrays correspond to.</span>
<a id="__codelineno-0-130" name="__codelineno-0-130"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-131" name="__codelineno-0-131"></a>    <span class="n">y_true</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">y_true</span><span class="p">)</span>  <span class="c1"># Ensure numpy array, if not already</span>
<a id="__codelineno-0-132" name="__codelineno-0-132"></a>    <span class="n">y_pred</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">y_pred</span><span class="p">)</span>
<a id="__codelineno-0-133" name="__codelineno-0-133"></a>
<a id="__codelineno-0-134" name="__codelineno-0-134"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">__validate_common_inputs</span><span class="p">(</span>
<a id="__codelineno-0-135" name="__codelineno-0-135"></a>        <span class="n">y_true</span><span class="o">=</span><span class="n">y_true</span><span class="p">,</span>
<a id="__codelineno-0-136" name="__codelineno-0-136"></a>        <span class="n">y_pred</span><span class="o">=</span><span class="n">y_pred</span><span class="p">,</span>
<a id="__codelineno-0-137" name="__codelineno-0-137"></a>        <span class="n">column_names</span><span class="o">=</span><span class="n">column_names</span><span class="p">,</span>
<a id="__codelineno-0-138" name="__codelineno-0-138"></a>    <span class="p">)</span>
<a id="__codelineno-0-139" name="__codelineno-0-139"></a>    <span class="c1"># Type checks</span>
<a id="__codelineno-0-140" name="__codelineno-0-140"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span>
<a id="__codelineno-0-141" name="__codelineno-0-141"></a>        <span class="n">np</span><span class="o">.</span><span class="n">issubdtype</span><span class="p">(</span><span class="n">y_true</span><span class="o">.</span><span class="n">dtype</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">integer</span><span class="p">)</span>
<a id="__codelineno-0-142" name="__codelineno-0-142"></a>        <span class="ow">or</span> <span class="n">np</span><span class="o">.</span><span class="n">issubdtype</span><span class="p">(</span><span class="n">y_true</span><span class="o">.</span><span class="n">dtype</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">str_</span><span class="p">)</span>
<a id="__codelineno-0-143" name="__codelineno-0-143"></a>    <span class="p">):</span>
<a id="__codelineno-0-144" name="__codelineno-0-144"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;y_true must contain integers or strings for labels&quot;</span><span class="p">)</span>
<a id="__codelineno-0-145" name="__codelineno-0-145"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span>
<a id="__codelineno-0-146" name="__codelineno-0-146"></a>        <span class="n">np</span><span class="o">.</span><span class="n">issubdtype</span><span class="p">(</span><span class="n">y_pred</span><span class="o">.</span><span class="n">dtype</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">integer</span><span class="p">)</span>
<a id="__codelineno-0-147" name="__codelineno-0-147"></a>        <span class="ow">or</span> <span class="n">np</span><span class="o">.</span><span class="n">issubdtype</span><span class="p">(</span><span class="n">y_pred</span><span class="o">.</span><span class="n">dtype</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">str_</span><span class="p">)</span>
<a id="__codelineno-0-148" name="__codelineno-0-148"></a>    <span class="p">):</span>
<a id="__codelineno-0-149" name="__codelineno-0-149"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;y_pred must contain integers or strings for labels&quot;</span><span class="p">)</span>
<a id="__codelineno-0-150" name="__codelineno-0-150"></a>
<a id="__codelineno-0-151" name="__codelineno-0-151"></a>    <span class="c1"># Get LABEL metric specs and compute</span>
<a id="__codelineno-0-152" name="__codelineno-0-152"></a>    <span class="n">label_specs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__get_label_specs</span><span class="p">()</span>
<a id="__codelineno-0-153" name="__codelineno-0-153"></a>    <span class="k">for</span> <span class="n">spec</span> <span class="ow">in</span> <span class="n">label_specs</span><span class="p">:</span>
<a id="__codelineno-0-154" name="__codelineno-0-154"></a>        <span class="n">spec</span><span class="o">.</span><span class="n">compute</span><span class="p">(</span>
<a id="__codelineno-0-155" name="__codelineno-0-155"></a>            <span class="n">y_true</span><span class="o">=</span><span class="n">y_true</span><span class="p">,</span>
<a id="__codelineno-0-156" name="__codelineno-0-156"></a>            <span class="n">y_pred</span><span class="o">=</span><span class="n">y_pred</span><span class="p">,</span>
<a id="__codelineno-0-157" name="__codelineno-0-157"></a>            <span class="n">column_names</span><span class="o">=</span><span class="n">column_names</span><span class="p">,</span>
<a id="__codelineno-0-158" name="__codelineno-0-158"></a>        <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="metrics_toolbox.evaluator.MetricEvaluator.add_model_evaluation" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">add_model_evaluation</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y_true</span><span class="p">,</span> <span class="n">column_names</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Evaluate a model and all included metrics.</p>
<p>This method does not know what your model <strong>predict()</strong> method returns,
and it is assumed you only include compatible metrics in the evaluator.
For example, classifier and regressor have the same predict() method signature,
but you should not mix classification and regression metrics in the same evaluator.</p>
<p>Mixing is allowed if you use the lower-level:</p>
<ul>
<li>
<p><strong>add_label_evaluation()</strong></p>
</li>
<li>
<p><strong>add_prob_evaluation()</strong></p>
</li>
<li>
<p><strong>add_regression_evaluation()</strong></p>
</li>
</ul>
<p>and you are able to inherit the Evaluator and create your own model evaluation logic.
You can build custom evaluators using the <strong>EvaluatorBuilder</strong>,
by passing your custom evaluator class to the <strong>build()</strong> method.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>model</code></b>
                  (<code><span title="Any">Any</span></code>)
              
              <div class="doc-md-description">
                <p>A model with predict and predict_proba methods.</p>
              </div>
            </li>
            <li>
              <b><code>X</code></b>
                  (<code><span title="numpy.ndarray">ndarray</span></code>)
              
              <div class="doc-md-description">
                <p>Input features for prediction.</p>
              </div>
            </li>
            <li>
              <b><code>y_true</code></b>
                  (<code><span title="numpy.ndarray">ndarray</span></code>)
              
              <div class="doc-md-description">
                <p>True labels. Ints or strings.</p>
              </div>
            </li>
            <li>
              <b><code>column_names</code></b>
                  (<code>Optional[List[str | int]] = None</code>, default:
                      <code>None</code>
)
              
              <div class="doc-md-description">
                <p>Optional list of column names to use for evaluation.
If not provided, will attempt to infer from model classes or use default indices.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

            <details class="mkdocstrings-source">
              <summary>Source code in <code>metrics_toolbox/evaluator.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-195">195</a></span>
<span class="normal"><a href="#__codelineno-0-196">196</a></span>
<span class="normal"><a href="#__codelineno-0-197">197</a></span>
<span class="normal"><a href="#__codelineno-0-198">198</a></span>
<span class="normal"><a href="#__codelineno-0-199">199</a></span>
<span class="normal"><a href="#__codelineno-0-200">200</a></span>
<span class="normal"><a href="#__codelineno-0-201">201</a></span>
<span class="normal"><a href="#__codelineno-0-202">202</a></span>
<span class="normal"><a href="#__codelineno-0-203">203</a></span>
<span class="normal"><a href="#__codelineno-0-204">204</a></span>
<span class="normal"><a href="#__codelineno-0-205">205</a></span>
<span class="normal"><a href="#__codelineno-0-206">206</a></span>
<span class="normal"><a href="#__codelineno-0-207">207</a></span>
<span class="normal"><a href="#__codelineno-0-208">208</a></span>
<span class="normal"><a href="#__codelineno-0-209">209</a></span>
<span class="normal"><a href="#__codelineno-0-210">210</a></span>
<span class="normal"><a href="#__codelineno-0-211">211</a></span>
<span class="normal"><a href="#__codelineno-0-212">212</a></span>
<span class="normal"><a href="#__codelineno-0-213">213</a></span>
<span class="normal"><a href="#__codelineno-0-214">214</a></span>
<span class="normal"><a href="#__codelineno-0-215">215</a></span>
<span class="normal"><a href="#__codelineno-0-216">216</a></span>
<span class="normal"><a href="#__codelineno-0-217">217</a></span>
<span class="normal"><a href="#__codelineno-0-218">218</a></span>
<span class="normal"><a href="#__codelineno-0-219">219</a></span>
<span class="normal"><a href="#__codelineno-0-220">220</a></span>
<span class="normal"><a href="#__codelineno-0-221">221</a></span>
<span class="normal"><a href="#__codelineno-0-222">222</a></span>
<span class="normal"><a href="#__codelineno-0-223">223</a></span>
<span class="normal"><a href="#__codelineno-0-224">224</a></span>
<span class="normal"><a href="#__codelineno-0-225">225</a></span>
<span class="normal"><a href="#__codelineno-0-226">226</a></span>
<span class="normal"><a href="#__codelineno-0-227">227</a></span>
<span class="normal"><a href="#__codelineno-0-228">228</a></span>
<span class="normal"><a href="#__codelineno-0-229">229</a></span>
<span class="normal"><a href="#__codelineno-0-230">230</a></span>
<span class="normal"><a href="#__codelineno-0-231">231</a></span>
<span class="normal"><a href="#__codelineno-0-232">232</a></span>
<span class="normal"><a href="#__codelineno-0-233">233</a></span>
<span class="normal"><a href="#__codelineno-0-234">234</a></span>
<span class="normal"><a href="#__codelineno-0-235">235</a></span>
<span class="normal"><a href="#__codelineno-0-236">236</a></span>
<span class="normal"><a href="#__codelineno-0-237">237</a></span>
<span class="normal"><a href="#__codelineno-0-238">238</a></span>
<span class="normal"><a href="#__codelineno-0-239">239</a></span>
<span class="normal"><a href="#__codelineno-0-240">240</a></span>
<span class="normal"><a href="#__codelineno-0-241">241</a></span>
<span class="normal"><a href="#__codelineno-0-242">242</a></span>
<span class="normal"><a href="#__codelineno-0-243">243</a></span>
<span class="normal"><a href="#__codelineno-0-244">244</a></span>
<span class="normal"><a href="#__codelineno-0-245">245</a></span>
<span class="normal"><a href="#__codelineno-0-246">246</a></span>
<span class="normal"><a href="#__codelineno-0-247">247</a></span>
<span class="normal"><a href="#__codelineno-0-248">248</a></span>
<span class="normal"><a href="#__codelineno-0-249">249</a></span>
<span class="normal"><a href="#__codelineno-0-250">250</a></span>
<span class="normal"><a href="#__codelineno-0-251">251</a></span>
<span class="normal"><a href="#__codelineno-0-252">252</a></span>
<span class="normal"><a href="#__codelineno-0-253">253</a></span>
<span class="normal"><a href="#__codelineno-0-254">254</a></span>
<span class="normal"><a href="#__codelineno-0-255">255</a></span>
<span class="normal"><a href="#__codelineno-0-256">256</a></span>
<span class="normal"><a href="#__codelineno-0-257">257</a></span>
<span class="normal"><a href="#__codelineno-0-258">258</a></span>
<span class="normal"><a href="#__codelineno-0-259">259</a></span>
<span class="normal"><a href="#__codelineno-0-260">260</a></span>
<span class="normal"><a href="#__codelineno-0-261">261</a></span>
<span class="normal"><a href="#__codelineno-0-262">262</a></span>
<span class="normal"><a href="#__codelineno-0-263">263</a></span>
<span class="normal"><a href="#__codelineno-0-264">264</a></span>
<span class="normal"><a href="#__codelineno-0-265">265</a></span>
<span class="normal"><a href="#__codelineno-0-266">266</a></span>
<span class="normal"><a href="#__codelineno-0-267">267</a></span>
<span class="normal"><a href="#__codelineno-0-268">268</a></span>
<span class="normal"><a href="#__codelineno-0-269">269</a></span>
<span class="normal"><a href="#__codelineno-0-270">270</a></span>
<span class="normal"><a href="#__codelineno-0-271">271</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-195" name="__codelineno-0-195"></a><span class="k">def</span><span class="w"> </span><span class="nf">add_model_evaluation</span><span class="p">(</span>
<a id="__codelineno-0-196" name="__codelineno-0-196"></a>    <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-197" name="__codelineno-0-197"></a>    <span class="n">model</span><span class="p">,</span>
<a id="__codelineno-0-198" name="__codelineno-0-198"></a>    <span class="n">X</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
<a id="__codelineno-0-199" name="__codelineno-0-199"></a>    <span class="n">y_true</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
<a id="__codelineno-0-200" name="__codelineno-0-200"></a>    <span class="n">column_names</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span> <span class="o">|</span> <span class="nb">int</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-201" name="__codelineno-0-201"></a><span class="p">):</span>
<a id="__codelineno-0-202" name="__codelineno-0-202"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Evaluate a model and all included metrics.</span>
<a id="__codelineno-0-203" name="__codelineno-0-203"></a>
<a id="__codelineno-0-204" name="__codelineno-0-204"></a><span class="sd">    This method does not know what your model **predict()** method returns,</span>
<a id="__codelineno-0-205" name="__codelineno-0-205"></a><span class="sd">    and it is assumed you only include compatible metrics in the evaluator.</span>
<a id="__codelineno-0-206" name="__codelineno-0-206"></a><span class="sd">    For example, classifier and regressor have the same predict() method signature,</span>
<a id="__codelineno-0-207" name="__codelineno-0-207"></a><span class="sd">    but you should not mix classification and regression metrics in the same evaluator.</span>
<a id="__codelineno-0-208" name="__codelineno-0-208"></a>
<a id="__codelineno-0-209" name="__codelineno-0-209"></a><span class="sd">    Mixing is allowed if you use the lower-level:</span>
<a id="__codelineno-0-210" name="__codelineno-0-210"></a>
<a id="__codelineno-0-211" name="__codelineno-0-211"></a><span class="sd">    - **add_label_evaluation()**</span>
<a id="__codelineno-0-212" name="__codelineno-0-212"></a>
<a id="__codelineno-0-213" name="__codelineno-0-213"></a><span class="sd">    - **add_prob_evaluation()**</span>
<a id="__codelineno-0-214" name="__codelineno-0-214"></a>
<a id="__codelineno-0-215" name="__codelineno-0-215"></a><span class="sd">    - **add_regression_evaluation()**</span>
<a id="__codelineno-0-216" name="__codelineno-0-216"></a>
<a id="__codelineno-0-217" name="__codelineno-0-217"></a><span class="sd">    and you are able to inherit the Evaluator and create your own model evaluation logic.</span>
<a id="__codelineno-0-218" name="__codelineno-0-218"></a><span class="sd">    You can build custom evaluators using the **EvaluatorBuilder**,</span>
<a id="__codelineno-0-219" name="__codelineno-0-219"></a><span class="sd">    by passing your custom evaluator class to the **build()** method.</span>
<a id="__codelineno-0-220" name="__codelineno-0-220"></a>
<a id="__codelineno-0-221" name="__codelineno-0-221"></a><span class="sd">    Parameters</span>
<a id="__codelineno-0-222" name="__codelineno-0-222"></a><span class="sd">    ----------</span>
<a id="__codelineno-0-223" name="__codelineno-0-223"></a><span class="sd">    model : Any</span>
<a id="__codelineno-0-224" name="__codelineno-0-224"></a><span class="sd">        A model with predict and predict_proba methods.</span>
<a id="__codelineno-0-225" name="__codelineno-0-225"></a><span class="sd">    X : np.ndarray</span>
<a id="__codelineno-0-226" name="__codelineno-0-226"></a><span class="sd">        Input features for prediction.</span>
<a id="__codelineno-0-227" name="__codelineno-0-227"></a><span class="sd">    y_true : np.ndarray</span>
<a id="__codelineno-0-228" name="__codelineno-0-228"></a><span class="sd">        True labels. Ints or strings.</span>
<a id="__codelineno-0-229" name="__codelineno-0-229"></a><span class="sd">    column_names : Optional[List[str | int]] = None</span>
<a id="__codelineno-0-230" name="__codelineno-0-230"></a><span class="sd">        Optional list of column names to use for evaluation.</span>
<a id="__codelineno-0-231" name="__codelineno-0-231"></a><span class="sd">        If not provided, will attempt to infer from model classes or use default indices.</span>
<a id="__codelineno-0-232" name="__codelineno-0-232"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-233" name="__codelineno-0-233"></a>
<a id="__codelineno-0-234" name="__codelineno-0-234"></a>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">__get_label_specs</span><span class="p">():</span>  <span class="c1"># If there are LABEL metrics to evaluate</span>
<a id="__codelineno-0-235" name="__codelineno-0-235"></a>        <span class="n">classes</span> <span class="o">=</span> <span class="p">(</span>
<a id="__codelineno-0-236" name="__codelineno-0-236"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">__get_model_classes</span><span class="p">(</span><span class="n">model</span><span class="p">)</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">column_names</span> <span class="k">else</span> <span class="n">column_names</span>
<a id="__codelineno-0-237" name="__codelineno-0-237"></a>        <span class="p">)</span>
<a id="__codelineno-0-238" name="__codelineno-0-238"></a>        <span class="n">y_pred</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
<a id="__codelineno-0-239" name="__codelineno-0-239"></a>        <span class="n">y_pred</span> <span class="o">=</span> <span class="n">toolbox_binarize_labels</span><span class="p">(</span><span class="n">y_pred</span><span class="p">,</span> <span class="n">classes</span><span class="p">)</span>
<a id="__codelineno-0-240" name="__codelineno-0-240"></a>        <span class="n">y_true</span> <span class="o">=</span> <span class="n">toolbox_binarize_labels</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">classes</span><span class="p">)</span>
<a id="__codelineno-0-241" name="__codelineno-0-241"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">add_label_evaluation</span><span class="p">(</span>
<a id="__codelineno-0-242" name="__codelineno-0-242"></a>            <span class="n">y_true</span><span class="o">=</span><span class="n">y_true</span><span class="p">,</span>
<a id="__codelineno-0-243" name="__codelineno-0-243"></a>            <span class="n">y_pred</span><span class="o">=</span><span class="n">y_pred</span><span class="p">,</span>
<a id="__codelineno-0-244" name="__codelineno-0-244"></a>            <span class="n">column_names</span><span class="o">=</span><span class="n">classes</span><span class="p">,</span>
<a id="__codelineno-0-245" name="__codelineno-0-245"></a>        <span class="p">)</span>
<a id="__codelineno-0-246" name="__codelineno-0-246"></a>
<a id="__codelineno-0-247" name="__codelineno-0-247"></a>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">__get_prob_specs</span><span class="p">():</span>  <span class="c1"># If there are PROB metrics to evaluate</span>
<a id="__codelineno-0-248" name="__codelineno-0-248"></a>        <span class="n">classes</span> <span class="o">=</span> <span class="p">(</span>
<a id="__codelineno-0-249" name="__codelineno-0-249"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">__get_model_classes</span><span class="p">(</span><span class="n">model</span><span class="p">)</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">column_names</span> <span class="k">else</span> <span class="n">column_names</span>
<a id="__codelineno-0-250" name="__codelineno-0-250"></a>        <span class="p">)</span>
<a id="__codelineno-0-251" name="__codelineno-0-251"></a>        <span class="n">y_pred</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
<a id="__codelineno-0-252" name="__codelineno-0-252"></a>        <span class="n">y_pred</span> <span class="o">=</span> <span class="n">toolbox_binarize_probs</span><span class="p">(</span><span class="n">y_pred</span><span class="p">)</span>
<a id="__codelineno-0-253" name="__codelineno-0-253"></a>        <span class="n">y_true</span> <span class="o">=</span> <span class="n">toolbox_binarize_labels</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">classes</span><span class="p">)</span>
<a id="__codelineno-0-254" name="__codelineno-0-254"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">add_prob_evaluation</span><span class="p">(</span>
<a id="__codelineno-0-255" name="__codelineno-0-255"></a>            <span class="n">y_true</span><span class="o">=</span><span class="n">y_true</span><span class="p">,</span>
<a id="__codelineno-0-256" name="__codelineno-0-256"></a>            <span class="n">y_pred</span><span class="o">=</span><span class="n">y_pred</span><span class="p">,</span>
<a id="__codelineno-0-257" name="__codelineno-0-257"></a>            <span class="n">column_names</span><span class="o">=</span><span class="n">classes</span><span class="p">,</span>
<a id="__codelineno-0-258" name="__codelineno-0-258"></a>        <span class="p">)</span>
<a id="__codelineno-0-259" name="__codelineno-0-259"></a>
<a id="__codelineno-0-260" name="__codelineno-0-260"></a>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">__get_regression_specs</span><span class="p">():</span>  <span class="c1"># If there are regression metrics to evaluate</span>
<a id="__codelineno-0-261" name="__codelineno-0-261"></a>        <span class="n">column_names</span> <span class="o">=</span> <span class="p">(</span>
<a id="__codelineno-0-262" name="__codelineno-0-262"></a>            <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">y_true</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">column_names</span> <span class="k">else</span> <span class="n">column_names</span>
<a id="__codelineno-0-263" name="__codelineno-0-263"></a>        <span class="p">)</span>
<a id="__codelineno-0-264" name="__codelineno-0-264"></a>        <span class="n">y_pred</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
<a id="__codelineno-0-265" name="__codelineno-0-265"></a>        <span class="n">y_pred</span> <span class="o">=</span> <span class="n">toolbox_widen_series</span><span class="p">(</span><span class="n">y_pred</span><span class="p">)</span>
<a id="__codelineno-0-266" name="__codelineno-0-266"></a>        <span class="n">y_true</span> <span class="o">=</span> <span class="n">toolbox_widen_series</span><span class="p">(</span><span class="n">y_true</span><span class="p">)</span>
<a id="__codelineno-0-267" name="__codelineno-0-267"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">add_regression_evaluation</span><span class="p">(</span>
<a id="__codelineno-0-268" name="__codelineno-0-268"></a>            <span class="n">y_true</span><span class="o">=</span><span class="n">y_true</span><span class="p">,</span>
<a id="__codelineno-0-269" name="__codelineno-0-269"></a>            <span class="n">y_pred</span><span class="o">=</span><span class="n">y_pred</span><span class="p">,</span>
<a id="__codelineno-0-270" name="__codelineno-0-270"></a>            <span class="n">column_names</span><span class="o">=</span><span class="n">column_names</span><span class="p">,</span>
<a id="__codelineno-0-271" name="__codelineno-0-271"></a>        <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="metrics_toolbox.evaluator.MetricEvaluator.add_prob_evaluation" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">add_prob_evaluation</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">column_names</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Evaluate PROB metrics and add new step to history.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>y_true</code></b>
                  (<code><span title="numpy.ndarray">ndarray</span></code>)
              
              <div class="doc-md-description">
                <p>True labels. Ints or strings.</p>
              </div>
            </li>
            <li>
              <b><code>y_pred</code></b>
                  (<code><span title="numpy.ndarray">ndarray</span></code>)
              
              <div class="doc-md-description">
                <p>Predicted probabilities. Shape (n_samples, n_classes).</p>
              </div>
            </li>
            <li>
              <b><code>column_names</code></b>
                  (<code>(<span title="typing.List">List</span>[<span title="str">str</span> | <span title="int">int</span>],)</code>)
              
              <div class="doc-md-description">
                <p>The names of the columns/classes the input arrays correspond to.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

            <details class="mkdocstrings-source">
              <summary>Source code in <code>metrics_toolbox/evaluator.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-64"> 64</a></span>
<span class="normal"><a href="#__codelineno-0-65"> 65</a></span>
<span class="normal"><a href="#__codelineno-0-66"> 66</a></span>
<span class="normal"><a href="#__codelineno-0-67"> 67</a></span>
<span class="normal"><a href="#__codelineno-0-68"> 68</a></span>
<span class="normal"><a href="#__codelineno-0-69"> 69</a></span>
<span class="normal"><a href="#__codelineno-0-70"> 70</a></span>
<span class="normal"><a href="#__codelineno-0-71"> 71</a></span>
<span class="normal"><a href="#__codelineno-0-72"> 72</a></span>
<span class="normal"><a href="#__codelineno-0-73"> 73</a></span>
<span class="normal"><a href="#__codelineno-0-74"> 74</a></span>
<span class="normal"><a href="#__codelineno-0-75"> 75</a></span>
<span class="normal"><a href="#__codelineno-0-76"> 76</a></span>
<span class="normal"><a href="#__codelineno-0-77"> 77</a></span>
<span class="normal"><a href="#__codelineno-0-78"> 78</a></span>
<span class="normal"><a href="#__codelineno-0-79"> 79</a></span>
<span class="normal"><a href="#__codelineno-0-80"> 80</a></span>
<span class="normal"><a href="#__codelineno-0-81"> 81</a></span>
<span class="normal"><a href="#__codelineno-0-82"> 82</a></span>
<span class="normal"><a href="#__codelineno-0-83"> 83</a></span>
<span class="normal"><a href="#__codelineno-0-84"> 84</a></span>
<span class="normal"><a href="#__codelineno-0-85"> 85</a></span>
<span class="normal"><a href="#__codelineno-0-86"> 86</a></span>
<span class="normal"><a href="#__codelineno-0-87"> 87</a></span>
<span class="normal"><a href="#__codelineno-0-88"> 88</a></span>
<span class="normal"><a href="#__codelineno-0-89"> 89</a></span>
<span class="normal"><a href="#__codelineno-0-90"> 90</a></span>
<span class="normal"><a href="#__codelineno-0-91"> 91</a></span>
<span class="normal"><a href="#__codelineno-0-92"> 92</a></span>
<span class="normal"><a href="#__codelineno-0-93"> 93</a></span>
<span class="normal"><a href="#__codelineno-0-94"> 94</a></span>
<span class="normal"><a href="#__codelineno-0-95"> 95</a></span>
<span class="normal"><a href="#__codelineno-0-96"> 96</a></span>
<span class="normal"><a href="#__codelineno-0-97"> 97</a></span>
<span class="normal"><a href="#__codelineno-0-98"> 98</a></span>
<span class="normal"><a href="#__codelineno-0-99"> 99</a></span>
<span class="normal"><a href="#__codelineno-0-100">100</a></span>
<span class="normal"><a href="#__codelineno-0-101">101</a></span>
<span class="normal"><a href="#__codelineno-0-102">102</a></span>
<span class="normal"><a href="#__codelineno-0-103">103</a></span>
<span class="normal"><a href="#__codelineno-0-104">104</a></span>
<span class="normal"><a href="#__codelineno-0-105">105</a></span>
<span class="normal"><a href="#__codelineno-0-106">106</a></span>
<span class="normal"><a href="#__codelineno-0-107">107</a></span>
<span class="normal"><a href="#__codelineno-0-108">108</a></span>
<span class="normal"><a href="#__codelineno-0-109">109</a></span>
<span class="normal"><a href="#__codelineno-0-110">110</a></span>
<span class="normal"><a href="#__codelineno-0-111">111</a></span>
<span class="normal"><a href="#__codelineno-0-112">112</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-64" name="__codelineno-0-64"></a><span class="k">def</span><span class="w"> </span><span class="nf">add_prob_evaluation</span><span class="p">(</span>
<a id="__codelineno-0-65" name="__codelineno-0-65"></a>    <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-66" name="__codelineno-0-66"></a>    <span class="n">y_true</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
<a id="__codelineno-0-67" name="__codelineno-0-67"></a>    <span class="n">y_pred</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
<a id="__codelineno-0-68" name="__codelineno-0-68"></a>    <span class="n">column_names</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span> <span class="o">|</span> <span class="nb">int</span><span class="p">],</span>
<a id="__codelineno-0-69" name="__codelineno-0-69"></a><span class="p">):</span>
<a id="__codelineno-0-70" name="__codelineno-0-70"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Evaluate PROB metrics and add new step to history.</span>
<a id="__codelineno-0-71" name="__codelineno-0-71"></a>
<a id="__codelineno-0-72" name="__codelineno-0-72"></a><span class="sd">    Parameters</span>
<a id="__codelineno-0-73" name="__codelineno-0-73"></a><span class="sd">    ----------</span>
<a id="__codelineno-0-74" name="__codelineno-0-74"></a><span class="sd">    y_true : np.ndarray</span>
<a id="__codelineno-0-75" name="__codelineno-0-75"></a><span class="sd">        True labels. Ints or strings.</span>
<a id="__codelineno-0-76" name="__codelineno-0-76"></a><span class="sd">    y_pred : np.ndarray</span>
<a id="__codelineno-0-77" name="__codelineno-0-77"></a><span class="sd">        Predicted probabilities. Shape (n_samples, n_classes).</span>
<a id="__codelineno-0-78" name="__codelineno-0-78"></a><span class="sd">    column_names : List[str | int],</span>
<a id="__codelineno-0-79" name="__codelineno-0-79"></a><span class="sd">        The names of the columns/classes the input arrays correspond to.</span>
<a id="__codelineno-0-80" name="__codelineno-0-80"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-81" name="__codelineno-0-81"></a>    <span class="n">y_true</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">y_true</span><span class="p">)</span>  <span class="c1"># Ensure numpy array, if not already</span>
<a id="__codelineno-0-82" name="__codelineno-0-82"></a>    <span class="n">y_pred</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">y_pred</span><span class="p">)</span>
<a id="__codelineno-0-83" name="__codelineno-0-83"></a>
<a id="__codelineno-0-84" name="__codelineno-0-84"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">__validate_common_inputs</span><span class="p">(</span>
<a id="__codelineno-0-85" name="__codelineno-0-85"></a>        <span class="n">y_true</span><span class="o">=</span><span class="n">y_true</span><span class="p">,</span>
<a id="__codelineno-0-86" name="__codelineno-0-86"></a>        <span class="n">y_pred</span><span class="o">=</span><span class="n">y_pred</span><span class="p">,</span>
<a id="__codelineno-0-87" name="__codelineno-0-87"></a>        <span class="n">column_names</span><span class="o">=</span><span class="n">column_names</span><span class="p">,</span>
<a id="__codelineno-0-88" name="__codelineno-0-88"></a>    <span class="p">)</span>
<a id="__codelineno-0-89" name="__codelineno-0-89"></a>
<a id="__codelineno-0-90" name="__codelineno-0-90"></a>    <span class="c1"># Type checks</span>
<a id="__codelineno-0-91" name="__codelineno-0-91"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span>
<a id="__codelineno-0-92" name="__codelineno-0-92"></a>        <span class="n">np</span><span class="o">.</span><span class="n">issubdtype</span><span class="p">(</span><span class="n">y_true</span><span class="o">.</span><span class="n">dtype</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">integer</span><span class="p">)</span>
<a id="__codelineno-0-93" name="__codelineno-0-93"></a>        <span class="ow">or</span> <span class="n">np</span><span class="o">.</span><span class="n">issubdtype</span><span class="p">(</span><span class="n">y_true</span><span class="o">.</span><span class="n">dtype</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">str_</span><span class="p">)</span>
<a id="__codelineno-0-94" name="__codelineno-0-94"></a>    <span class="p">):</span>
<a id="__codelineno-0-95" name="__codelineno-0-95"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-96" name="__codelineno-0-96"></a>            <span class="s2">&quot;y_true must contain integers or strings for probabilities&quot;</span>
<a id="__codelineno-0-97" name="__codelineno-0-97"></a>        <span class="p">)</span>
<a id="__codelineno-0-98" name="__codelineno-0-98"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">issubdtype</span><span class="p">(</span><span class="n">y_pred</span><span class="o">.</span><span class="n">dtype</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">floating</span><span class="p">):</span>
<a id="__codelineno-0-99" name="__codelineno-0-99"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;y_pred must contain floats for probabilities&quot;</span><span class="p">)</span>
<a id="__codelineno-0-100" name="__codelineno-0-100"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">((</span><span class="n">y_pred</span> <span class="o">&gt;=</span> <span class="mf">0.0</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">y_pred</span> <span class="o">&lt;=</span> <span class="mf">1.0</span><span class="p">)):</span>
<a id="__codelineno-0-101" name="__codelineno-0-101"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-102" name="__codelineno-0-102"></a>            <span class="s2">&quot;y_pred must contain probabilities in the range [0.0, 1.0]&quot;</span>
<a id="__codelineno-0-103" name="__codelineno-0-103"></a>        <span class="p">)</span>
<a id="__codelineno-0-104" name="__codelineno-0-104"></a>
<a id="__codelineno-0-105" name="__codelineno-0-105"></a>    <span class="c1"># Get PROB metric specs and compute</span>
<a id="__codelineno-0-106" name="__codelineno-0-106"></a>    <span class="n">prob_specs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__get_prob_specs</span><span class="p">()</span>
<a id="__codelineno-0-107" name="__codelineno-0-107"></a>    <span class="k">for</span> <span class="n">spec</span> <span class="ow">in</span> <span class="n">prob_specs</span><span class="p">:</span>
<a id="__codelineno-0-108" name="__codelineno-0-108"></a>        <span class="n">spec</span><span class="o">.</span><span class="n">compute</span><span class="p">(</span>
<a id="__codelineno-0-109" name="__codelineno-0-109"></a>            <span class="n">y_true</span><span class="o">=</span><span class="n">y_true</span><span class="p">,</span>
<a id="__codelineno-0-110" name="__codelineno-0-110"></a>            <span class="n">y_pred</span><span class="o">=</span><span class="n">y_pred</span><span class="p">,</span>
<a id="__codelineno-0-111" name="__codelineno-0-111"></a>            <span class="n">column_names</span><span class="o">=</span><span class="n">column_names</span><span class="p">,</span>
<a id="__codelineno-0-112" name="__codelineno-0-112"></a>        <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="metrics_toolbox.evaluator.MetricEvaluator.add_regression_evaluation" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">add_regression_evaluation</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">column_names</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Evaluate SCORE metrics and add new step to history.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>y_true</code></b>
                  (<code><span title="numpy.ndarray">ndarray</span></code>)
              
              <div class="doc-md-description">
                <p>True series values. Shape (n_samples, n_targets).</p>
              </div>
            </li>
            <li>
              <b><code>y_pred</code></b>
                  (<code><span title="numpy.ndarray">ndarray</span></code>)
              
              <div class="doc-md-description">
                <p>Predicted series values. Shape (n_samples, n_targets).</p>
              </div>
            </li>
            <li>
              <b><code>column_names</code></b>
                  (<code>(<span title="typing.List">List</span>[<span title="str">str</span> | <span title="int">int</span>],)</code>)
              
              <div class="doc-md-description">
                <p>The names of the columns/classes the input arrays correspond to.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

            <details class="mkdocstrings-source">
              <summary>Source code in <code>metrics_toolbox/evaluator.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-160">160</a></span>
<span class="normal"><a href="#__codelineno-0-161">161</a></span>
<span class="normal"><a href="#__codelineno-0-162">162</a></span>
<span class="normal"><a href="#__codelineno-0-163">163</a></span>
<span class="normal"><a href="#__codelineno-0-164">164</a></span>
<span class="normal"><a href="#__codelineno-0-165">165</a></span>
<span class="normal"><a href="#__codelineno-0-166">166</a></span>
<span class="normal"><a href="#__codelineno-0-167">167</a></span>
<span class="normal"><a href="#__codelineno-0-168">168</a></span>
<span class="normal"><a href="#__codelineno-0-169">169</a></span>
<span class="normal"><a href="#__codelineno-0-170">170</a></span>
<span class="normal"><a href="#__codelineno-0-171">171</a></span>
<span class="normal"><a href="#__codelineno-0-172">172</a></span>
<span class="normal"><a href="#__codelineno-0-173">173</a></span>
<span class="normal"><a href="#__codelineno-0-174">174</a></span>
<span class="normal"><a href="#__codelineno-0-175">175</a></span>
<span class="normal"><a href="#__codelineno-0-176">176</a></span>
<span class="normal"><a href="#__codelineno-0-177">177</a></span>
<span class="normal"><a href="#__codelineno-0-178">178</a></span>
<span class="normal"><a href="#__codelineno-0-179">179</a></span>
<span class="normal"><a href="#__codelineno-0-180">180</a></span>
<span class="normal"><a href="#__codelineno-0-181">181</a></span>
<span class="normal"><a href="#__codelineno-0-182">182</a></span>
<span class="normal"><a href="#__codelineno-0-183">183</a></span>
<span class="normal"><a href="#__codelineno-0-184">184</a></span>
<span class="normal"><a href="#__codelineno-0-185">185</a></span>
<span class="normal"><a href="#__codelineno-0-186">186</a></span>
<span class="normal"><a href="#__codelineno-0-187">187</a></span>
<span class="normal"><a href="#__codelineno-0-188">188</a></span>
<span class="normal"><a href="#__codelineno-0-189">189</a></span>
<span class="normal"><a href="#__codelineno-0-190">190</a></span>
<span class="normal"><a href="#__codelineno-0-191">191</a></span>
<span class="normal"><a href="#__codelineno-0-192">192</a></span>
<span class="normal"><a href="#__codelineno-0-193">193</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-160" name="__codelineno-0-160"></a><span class="k">def</span><span class="w"> </span><span class="nf">add_regression_evaluation</span><span class="p">(</span>
<a id="__codelineno-0-161" name="__codelineno-0-161"></a>    <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-162" name="__codelineno-0-162"></a>    <span class="n">y_true</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
<a id="__codelineno-0-163" name="__codelineno-0-163"></a>    <span class="n">y_pred</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
<a id="__codelineno-0-164" name="__codelineno-0-164"></a>    <span class="n">column_names</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span> <span class="o">|</span> <span class="nb">int</span><span class="p">],</span>
<a id="__codelineno-0-165" name="__codelineno-0-165"></a><span class="p">):</span>
<a id="__codelineno-0-166" name="__codelineno-0-166"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Evaluate SCORE metrics and add new step to history.</span>
<a id="__codelineno-0-167" name="__codelineno-0-167"></a>
<a id="__codelineno-0-168" name="__codelineno-0-168"></a><span class="sd">    Parameters</span>
<a id="__codelineno-0-169" name="__codelineno-0-169"></a><span class="sd">    ----------</span>
<a id="__codelineno-0-170" name="__codelineno-0-170"></a><span class="sd">    y_true : np.ndarray</span>
<a id="__codelineno-0-171" name="__codelineno-0-171"></a><span class="sd">        True series values. Shape (n_samples, n_targets).</span>
<a id="__codelineno-0-172" name="__codelineno-0-172"></a><span class="sd">    y_pred : np.ndarray</span>
<a id="__codelineno-0-173" name="__codelineno-0-173"></a><span class="sd">        Predicted series values. Shape (n_samples, n_targets).</span>
<a id="__codelineno-0-174" name="__codelineno-0-174"></a><span class="sd">    column_names : List[str | int],</span>
<a id="__codelineno-0-175" name="__codelineno-0-175"></a><span class="sd">        The names of the columns/classes the input arrays correspond to.</span>
<a id="__codelineno-0-176" name="__codelineno-0-176"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-177" name="__codelineno-0-177"></a>    <span class="n">y_true</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">y_true</span><span class="p">)</span>  <span class="c1"># Ensure numpy array, if not already</span>
<a id="__codelineno-0-178" name="__codelineno-0-178"></a>    <span class="n">y_pred</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">y_pred</span><span class="p">)</span>
<a id="__codelineno-0-179" name="__codelineno-0-179"></a>
<a id="__codelineno-0-180" name="__codelineno-0-180"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">__validate_common_inputs</span><span class="p">(</span>
<a id="__codelineno-0-181" name="__codelineno-0-181"></a>        <span class="n">y_true</span><span class="o">=</span><span class="n">y_true</span><span class="p">,</span>
<a id="__codelineno-0-182" name="__codelineno-0-182"></a>        <span class="n">y_pred</span><span class="o">=</span><span class="n">y_pred</span><span class="p">,</span>
<a id="__codelineno-0-183" name="__codelineno-0-183"></a>        <span class="n">column_names</span><span class="o">=</span><span class="n">column_names</span><span class="p">,</span>
<a id="__codelineno-0-184" name="__codelineno-0-184"></a>    <span class="p">)</span>
<a id="__codelineno-0-185" name="__codelineno-0-185"></a>
<a id="__codelineno-0-186" name="__codelineno-0-186"></a>    <span class="c1"># Get SCORE metric specs and compute</span>
<a id="__codelineno-0-187" name="__codelineno-0-187"></a>    <span class="n">score_specs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__get_regression_specs</span><span class="p">()</span>
<a id="__codelineno-0-188" name="__codelineno-0-188"></a>    <span class="k">for</span> <span class="n">spec</span> <span class="ow">in</span> <span class="n">score_specs</span><span class="p">:</span>
<a id="__codelineno-0-189" name="__codelineno-0-189"></a>        <span class="n">spec</span><span class="o">.</span><span class="n">compute</span><span class="p">(</span>
<a id="__codelineno-0-190" name="__codelineno-0-190"></a>            <span class="n">y_true</span><span class="o">=</span><span class="n">y_true</span><span class="p">,</span>
<a id="__codelineno-0-191" name="__codelineno-0-191"></a>            <span class="n">y_pred</span><span class="o">=</span><span class="n">y_pred</span><span class="p">,</span>
<a id="__codelineno-0-192" name="__codelineno-0-192"></a>            <span class="n">column_names</span><span class="o">=</span><span class="n">column_names</span><span class="p">,</span>
<a id="__codelineno-0-193" name="__codelineno-0-193"></a>        <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="metrics_toolbox.evaluator.MetricEvaluator.get_results" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_results</span><span class="p">()</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Get evaluation results including reduced values, full history, and plots.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Returns:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
                  <code><span title="typing.Dict">Dict</span>[<span title="str">str</span>, <span title="typing.Dict">Dict</span>[<span title="str">str</span>, <span title="float">float</span> | <span title="list">list</span>[<span title="float">float</span>] | <span title="matplotlib.pyplot.Figure">Figure</span>]]</code>
              
              <div class="doc-md-description">
                <p>A dictionary with keys 'values', 'steps', and 'figures'.</p>
<ul>
<li>
<p><strong>values</strong>: Reduced metric values (e.g., mean, max).</p>
</li>
<li>
<p><strong>steps</strong>: Full history of metric values over evaluation steps.</p>
</li>
<li>
<p><strong>figures</strong>: Plots for applicable metrics (e.g., ROC AUC curves).</p>
</li>
</ul>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

            <details class="mkdocstrings-source">
              <summary>Source code in <code>metrics_toolbox/evaluator.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-273">273</a></span>
<span class="normal"><a href="#__codelineno-0-274">274</a></span>
<span class="normal"><a href="#__codelineno-0-275">275</a></span>
<span class="normal"><a href="#__codelineno-0-276">276</a></span>
<span class="normal"><a href="#__codelineno-0-277">277</a></span>
<span class="normal"><a href="#__codelineno-0-278">278</a></span>
<span class="normal"><a href="#__codelineno-0-279">279</a></span>
<span class="normal"><a href="#__codelineno-0-280">280</a></span>
<span class="normal"><a href="#__codelineno-0-281">281</a></span>
<span class="normal"><a href="#__codelineno-0-282">282</a></span>
<span class="normal"><a href="#__codelineno-0-283">283</a></span>
<span class="normal"><a href="#__codelineno-0-284">284</a></span>
<span class="normal"><a href="#__codelineno-0-285">285</a></span>
<span class="normal"><a href="#__codelineno-0-286">286</a></span>
<span class="normal"><a href="#__codelineno-0-287">287</a></span>
<span class="normal"><a href="#__codelineno-0-288">288</a></span>
<span class="normal"><a href="#__codelineno-0-289">289</a></span>
<span class="normal"><a href="#__codelineno-0-290">290</a></span>
<span class="normal"><a href="#__codelineno-0-291">291</a></span>
<span class="normal"><a href="#__codelineno-0-292">292</a></span>
<span class="normal"><a href="#__codelineno-0-293">293</a></span>
<span class="normal"><a href="#__codelineno-0-294">294</a></span>
<span class="normal"><a href="#__codelineno-0-295">295</a></span>
<span class="normal"><a href="#__codelineno-0-296">296</a></span>
<span class="normal"><a href="#__codelineno-0-297">297</a></span>
<span class="normal"><a href="#__codelineno-0-298">298</a></span>
<span class="normal"><a href="#__codelineno-0-299">299</a></span>
<span class="normal"><a href="#__codelineno-0-300">300</a></span>
<span class="normal"><a href="#__codelineno-0-301">301</a></span>
<span class="normal"><a href="#__codelineno-0-302">302</a></span>
<span class="normal"><a href="#__codelineno-0-303">303</a></span>
<span class="normal"><a href="#__codelineno-0-304">304</a></span>
<span class="normal"><a href="#__codelineno-0-305">305</a></span>
<span class="normal"><a href="#__codelineno-0-306">306</a></span>
<span class="normal"><a href="#__codelineno-0-307">307</a></span>
<span class="normal"><a href="#__codelineno-0-308">308</a></span>
<span class="normal"><a href="#__codelineno-0-309">309</a></span>
<span class="normal"><a href="#__codelineno-0-310">310</a></span>
<span class="normal"><a href="#__codelineno-0-311">311</a></span>
<span class="normal"><a href="#__codelineno-0-312">312</a></span>
<span class="normal"><a href="#__codelineno-0-313">313</a></span>
<span class="normal"><a href="#__codelineno-0-314">314</a></span>
<span class="normal"><a href="#__codelineno-0-315">315</a></span>
<span class="normal"><a href="#__codelineno-0-316">316</a></span>
<span class="normal"><a href="#__codelineno-0-317">317</a></span>
<span class="normal"><a href="#__codelineno-0-318">318</a></span>
<span class="normal"><a href="#__codelineno-0-319">319</a></span>
<span class="normal"><a href="#__codelineno-0-320">320</a></span>
<span class="normal"><a href="#__codelineno-0-321">321</a></span>
<span class="normal"><a href="#__codelineno-0-322">322</a></span>
<span class="normal"><a href="#__codelineno-0-323">323</a></span>
<span class="normal"><a href="#__codelineno-0-324">324</a></span>
<span class="normal"><a href="#__codelineno-0-325">325</a></span>
<span class="normal"><a href="#__codelineno-0-326">326</a></span>
<span class="normal"><a href="#__codelineno-0-327">327</a></span>
<span class="normal"><a href="#__codelineno-0-328">328</a></span>
<span class="normal"><a href="#__codelineno-0-329">329</a></span>
<span class="normal"><a href="#__codelineno-0-330">330</a></span>
<span class="normal"><a href="#__codelineno-0-331">331</a></span>
<span class="normal"><a href="#__codelineno-0-332">332</a></span>
<span class="normal"><a href="#__codelineno-0-333">333</a></span>
<span class="normal"><a href="#__codelineno-0-334">334</a></span>
<span class="normal"><a href="#__codelineno-0-335">335</a></span>
<span class="normal"><a href="#__codelineno-0-336">336</a></span>
<span class="normal"><a href="#__codelineno-0-337">337</a></span>
<span class="normal"><a href="#__codelineno-0-338">338</a></span>
<span class="normal"><a href="#__codelineno-0-339">339</a></span>
<span class="normal"><a href="#__codelineno-0-340">340</a></span>
<span class="normal"><a href="#__codelineno-0-341">341</a></span>
<span class="normal"><a href="#__codelineno-0-342">342</a></span>
<span class="normal"><a href="#__codelineno-0-343">343</a></span>
<span class="normal"><a href="#__codelineno-0-344">344</a></span>
<span class="normal"><a href="#__codelineno-0-345">345</a></span>
<span class="normal"><a href="#__codelineno-0-346">346</a></span>
<span class="normal"><a href="#__codelineno-0-347">347</a></span>
<span class="normal"><a href="#__codelineno-0-348">348</a></span>
<span class="normal"><a href="#__codelineno-0-349">349</a></span>
<span class="normal"><a href="#__codelineno-0-350">350</a></span>
<span class="normal"><a href="#__codelineno-0-351">351</a></span>
<span class="normal"><a href="#__codelineno-0-352">352</a></span>
<span class="normal"><a href="#__codelineno-0-353">353</a></span>
<span class="normal"><a href="#__codelineno-0-354">354</a></span>
<span class="normal"><a href="#__codelineno-0-355">355</a></span>
<span class="normal"><a href="#__codelineno-0-356">356</a></span>
<span class="normal"><a href="#__codelineno-0-357">357</a></span>
<span class="normal"><a href="#__codelineno-0-358">358</a></span>
<span class="normal"><a href="#__codelineno-0-359">359</a></span>
<span class="normal"><a href="#__codelineno-0-360">360</a></span>
<span class="normal"><a href="#__codelineno-0-361">361</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-273" name="__codelineno-0-273"></a><span class="k">def</span><span class="w"> </span><span class="nf">get_results</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">|</span> <span class="n">plt</span><span class="o">.</span><span class="n">Figure</span><span class="p">]]:</span>
<a id="__codelineno-0-274" name="__codelineno-0-274"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Get evaluation results including reduced values, full history, and plots.</span>
<a id="__codelineno-0-275" name="__codelineno-0-275"></a>
<a id="__codelineno-0-276" name="__codelineno-0-276"></a><span class="sd">    Returns</span>
<a id="__codelineno-0-277" name="__codelineno-0-277"></a><span class="sd">    -------</span>
<a id="__codelineno-0-278" name="__codelineno-0-278"></a><span class="sd">    Dict[str, Dict[str, float | list[float] | plt.Figure]]</span>
<a id="__codelineno-0-279" name="__codelineno-0-279"></a><span class="sd">        A dictionary with keys &#39;values&#39;, &#39;steps&#39;, and &#39;figures&#39;.</span>
<a id="__codelineno-0-280" name="__codelineno-0-280"></a>
<a id="__codelineno-0-281" name="__codelineno-0-281"></a><span class="sd">        - **values**: Reduced metric values (e.g., mean, max).</span>
<a id="__codelineno-0-282" name="__codelineno-0-282"></a>
<a id="__codelineno-0-283" name="__codelineno-0-283"></a><span class="sd">        - **steps**: Full history of metric values over evaluation steps.</span>
<a id="__codelineno-0-284" name="__codelineno-0-284"></a>
<a id="__codelineno-0-285" name="__codelineno-0-285"></a><span class="sd">        - **figures**: Plots for applicable metrics (e.g., ROC AUC curves).</span>
<a id="__codelineno-0-286" name="__codelineno-0-286"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-287" name="__codelineno-0-287"></a>
<a id="__codelineno-0-288" name="__codelineno-0-288"></a>    <span class="n">summary</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">|</span> <span class="n">plt</span><span class="o">.</span><span class="n">Figure</span><span class="p">]]</span> <span class="o">=</span> <span class="p">{</span>
<a id="__codelineno-0-289" name="__codelineno-0-289"></a>        <span class="s2">&quot;values&quot;</span><span class="p">:</span> <span class="p">{},</span>
<a id="__codelineno-0-290" name="__codelineno-0-290"></a>        <span class="s2">&quot;steps&quot;</span><span class="p">:</span> <span class="p">{},</span>
<a id="__codelineno-0-291" name="__codelineno-0-291"></a>        <span class="s2">&quot;figures&quot;</span><span class="p">:</span> <span class="p">{},</span>
<a id="__codelineno-0-292" name="__codelineno-0-292"></a>    <span class="p">}</span>
<a id="__codelineno-0-293" name="__codelineno-0-293"></a>
<a id="__codelineno-0-294" name="__codelineno-0-294"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_reduced_values</span><span class="p">(</span><span class="n">specs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">]:</span>
<a id="__codelineno-0-295" name="__codelineno-0-295"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Iterate over specs and fill reduced values.&quot;&quot;&quot;</span>
<a id="__codelineno-0-296" name="__codelineno-0-296"></a>        <span class="n">reduced</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-0-297" name="__codelineno-0-297"></a>        <span class="k">for</span> <span class="n">spec</span> <span class="ow">in</span> <span class="n">specs</span><span class="p">:</span>
<a id="__codelineno-0-298" name="__codelineno-0-298"></a>            <span class="n">reduced</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">spec</span><span class="o">.</span><span class="n">get_reduced_values</span><span class="p">())</span>  <span class="c1"># {roc_auc_mean: 0.85, ...}</span>
<a id="__codelineno-0-299" name="__codelineno-0-299"></a>        <span class="k">return</span> <span class="n">reduced</span>
<a id="__codelineno-0-300" name="__codelineno-0-300"></a>
<a id="__codelineno-0-301" name="__codelineno-0-301"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_full_history</span><span class="p">(</span><span class="n">specs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]]:</span>
<a id="__codelineno-0-302" name="__codelineno-0-302"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Iterate over specs ids in history and get full values over given</span>
<a id="__codelineno-0-303" name="__codelineno-0-303"></a><span class="sd">        specs.&quot;&quot;&quot;</span>
<a id="__codelineno-0-304" name="__codelineno-0-304"></a>        <span class="n">history</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-0-305" name="__codelineno-0-305"></a>        <span class="k">for</span> <span class="n">spec</span> <span class="ow">in</span> <span class="n">specs</span><span class="p">:</span>
<a id="__codelineno-0-306" name="__codelineno-0-306"></a>            <span class="n">history</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">spec</span><span class="o">.</span><span class="n">id</span><span class="si">}</span><span class="s2">_steps&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
<a id="__codelineno-0-307" name="__codelineno-0-307"></a>                <span class="n">spec</span><span class="o">.</span><span class="n">get_values_history</span><span class="p">()</span>
<a id="__codelineno-0-308" name="__codelineno-0-308"></a>            <span class="p">)</span>  <span class="c1"># {roc_auc_steps: [0.8, 0.85, ...], ...}</span>
<a id="__codelineno-0-309" name="__codelineno-0-309"></a>        <span class="k">return</span> <span class="n">history</span>
<a id="__codelineno-0-310" name="__codelineno-0-310"></a>
<a id="__codelineno-0-311" name="__codelineno-0-311"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_roc_auc_plots</span><span class="p">(</span><span class="n">specs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">plt</span><span class="o">.</span><span class="n">Figure</span><span class="p">]:</span>
<a id="__codelineno-0-312" name="__codelineno-0-312"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Generate ROC AUC plots for given specs.&quot;&quot;&quot;</span>
<a id="__codelineno-0-313" name="__codelineno-0-313"></a>        <span class="n">roc_auc_results</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-0-314" name="__codelineno-0-314"></a>        <span class="k">for</span> <span class="n">spec</span> <span class="ow">in</span> <span class="n">specs</span><span class="p">:</span>
<a id="__codelineno-0-315" name="__codelineno-0-315"></a>            <span class="k">if</span> <span class="n">spec</span><span class="o">.</span><span class="n">metric</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="n">MetricNameEnum</span><span class="o">.</span><span class="n">ROC_AUC</span><span class="p">:</span>
<a id="__codelineno-0-316" name="__codelineno-0-316"></a>                <span class="n">roc_auc_results</span><span class="p">[</span><span class="n">spec</span><span class="o">.</span><span class="n">id</span><span class="p">]</span> <span class="o">=</span> <span class="n">spec</span><span class="o">.</span><span class="n">get_results_history</span><span class="p">()</span>
<a id="__codelineno-0-317" name="__codelineno-0-317"></a>        <span class="k">if</span> <span class="n">roc_auc_results</span><span class="p">:</span>
<a id="__codelineno-0-318" name="__codelineno-0-318"></a>            <span class="n">fig</span> <span class="o">=</span> <span class="n">plot_auc_curves</span><span class="p">(</span>
<a id="__codelineno-0-319" name="__codelineno-0-319"></a>                <span class="n">auc_metrics</span><span class="o">=</span><span class="n">roc_auc_results</span><span class="p">,</span>
<a id="__codelineno-0-320" name="__codelineno-0-320"></a>                <span class="n">is_roc</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-321" name="__codelineno-0-321"></a>            <span class="p">)</span>
<a id="__codelineno-0-322" name="__codelineno-0-322"></a>            <span class="k">return</span> <span class="p">{</span><span class="s2">&quot;roc_auc_curves&quot;</span><span class="p">:</span> <span class="n">fig</span><span class="p">}</span>
<a id="__codelineno-0-323" name="__codelineno-0-323"></a>        <span class="k">return</span> <span class="p">{}</span>
<a id="__codelineno-0-324" name="__codelineno-0-324"></a>
<a id="__codelineno-0-325" name="__codelineno-0-325"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_confusion_matrix_plots</span><span class="p">(</span><span class="n">specs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">plt</span><span class="o">.</span><span class="n">Figure</span><span class="p">]:</span>
<a id="__codelineno-0-326" name="__codelineno-0-326"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Generate Confusion Matrix plots for given specs.&quot;&quot;&quot;</span>
<a id="__codelineno-0-327" name="__codelineno-0-327"></a>        <span class="n">cm_results</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-328" name="__codelineno-0-328"></a>        <span class="k">for</span> <span class="n">spec</span> <span class="ow">in</span> <span class="n">specs</span><span class="p">:</span>
<a id="__codelineno-0-329" name="__codelineno-0-329"></a>            <span class="k">if</span> <span class="p">(</span>
<a id="__codelineno-0-330" name="__codelineno-0-330"></a>                <span class="n">spec</span><span class="o">.</span><span class="n">metric</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="n">MetricNameEnum</span><span class="o">.</span><span class="n">ACCURACY</span>
<a id="__codelineno-0-331" name="__codelineno-0-331"></a>            <span class="p">):</span>  <span class="c1"># All accuracy metrics have cf in metadata</span>
<a id="__codelineno-0-332" name="__codelineno-0-332"></a>                <span class="n">cm_results</span> <span class="o">=</span> <span class="n">spec</span><span class="o">.</span><span class="n">get_results_history</span><span class="p">()</span>
<a id="__codelineno-0-333" name="__codelineno-0-333"></a>        <span class="k">if</span> <span class="n">cm_results</span><span class="p">:</span>
<a id="__codelineno-0-334" name="__codelineno-0-334"></a>            <span class="n">fig</span> <span class="o">=</span> <span class="n">plot_confusion_matrix</span><span class="p">(</span>
<a id="__codelineno-0-335" name="__codelineno-0-335"></a>                <span class="n">accuracy_results</span><span class="o">=</span><span class="n">cm_results</span><span class="p">,</span>
<a id="__codelineno-0-336" name="__codelineno-0-336"></a>            <span class="p">)</span>
<a id="__codelineno-0-337" name="__codelineno-0-337"></a>            <span class="k">return</span> <span class="p">{</span><span class="s2">&quot;confusion_matrices&quot;</span><span class="p">:</span> <span class="n">fig</span><span class="p">}</span>
<a id="__codelineno-0-338" name="__codelineno-0-338"></a>        <span class="k">return</span> <span class="p">{}</span>
<a id="__codelineno-0-339" name="__codelineno-0-339"></a>
<a id="__codelineno-0-340" name="__codelineno-0-340"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_regression_plots</span><span class="p">(</span><span class="n">specs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">plt</span><span class="o">.</span><span class="n">Figure</span><span class="p">]:</span>
<a id="__codelineno-0-341" name="__codelineno-0-341"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Generate regression plots for given specs.&quot;&quot;&quot;</span>
<a id="__codelineno-0-342" name="__codelineno-0-342"></a>        <span class="n">target_regression_results</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-0-343" name="__codelineno-0-343"></a>        <span class="k">for</span> <span class="n">spec</span> <span class="ow">in</span> <span class="n">specs</span><span class="p">:</span>
<a id="__codelineno-0-344" name="__codelineno-0-344"></a>            <span class="k">if</span> <span class="p">(</span>
<a id="__codelineno-0-345" name="__codelineno-0-345"></a>                <span class="n">spec</span><span class="o">.</span><span class="n">metric</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="n">MetricTypeEnum</span><span class="o">.</span><span class="n">SCORES</span>
<a id="__codelineno-0-346" name="__codelineno-0-346"></a>                <span class="ow">and</span> <span class="n">spec</span><span class="o">.</span><span class="n">metric</span><span class="o">.</span><span class="n">scope</span> <span class="o">==</span> <span class="n">MetricScopeEnum</span><span class="o">.</span><span class="n">TARGET</span>
<a id="__codelineno-0-347" name="__codelineno-0-347"></a>            <span class="p">):</span>
<a id="__codelineno-0-348" name="__codelineno-0-348"></a>                <span class="n">target_regression_results</span><span class="p">[</span><span class="n">spec</span><span class="o">.</span><span class="n">id</span><span class="p">]</span> <span class="o">=</span> <span class="n">spec</span><span class="o">.</span><span class="n">get_results_history</span><span class="p">()</span>
<a id="__codelineno-0-349" name="__codelineno-0-349"></a>        <span class="k">if</span> <span class="n">target_regression_results</span><span class="p">:</span>
<a id="__codelineno-0-350" name="__codelineno-0-350"></a>            <span class="n">fig</span> <span class="o">=</span> <span class="n">plot_regression_lines</span><span class="p">(</span>
<a id="__codelineno-0-351" name="__codelineno-0-351"></a>                <span class="n">regression_results</span><span class="o">=</span><span class="n">target_regression_results</span><span class="p">,</span>
<a id="__codelineno-0-352" name="__codelineno-0-352"></a>            <span class="p">)</span>
<a id="__codelineno-0-353" name="__codelineno-0-353"></a>            <span class="k">return</span> <span class="p">{</span><span class="s2">&quot;regression_plots&quot;</span><span class="p">:</span> <span class="n">fig</span><span class="p">}</span>
<a id="__codelineno-0-354" name="__codelineno-0-354"></a>        <span class="k">return</span> <span class="p">{}</span>
<a id="__codelineno-0-355" name="__codelineno-0-355"></a>
<a id="__codelineno-0-356" name="__codelineno-0-356"></a>    <span class="n">summary</span><span class="p">[</span><span class="s2">&quot;values&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">get_reduced_values</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_metric_specs</span><span class="p">))</span>
<a id="__codelineno-0-357" name="__codelineno-0-357"></a>    <span class="n">summary</span><span class="p">[</span><span class="s2">&quot;steps&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">get_full_history</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_metric_specs</span><span class="p">))</span>
<a id="__codelineno-0-358" name="__codelineno-0-358"></a>    <span class="n">summary</span><span class="p">[</span><span class="s2">&quot;figures&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">get_roc_auc_plots</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_metric_specs</span><span class="p">))</span>
<a id="__codelineno-0-359" name="__codelineno-0-359"></a>    <span class="n">summary</span><span class="p">[</span><span class="s2">&quot;figures&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">get_confusion_matrix_plots</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_metric_specs</span><span class="p">))</span>
<a id="__codelineno-0-360" name="__codelineno-0-360"></a>    <span class="n">summary</span><span class="p">[</span><span class="s2">&quot;figures&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">get_regression_plots</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_metric_specs</span><span class="p">))</span>
<a id="__codelineno-0-361" name="__codelineno-0-361"></a>    <span class="k">return</span> <span class="n">summary</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>


</div>




  </div>

    </div>

</div>
              
            </div>
          </div><footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="Footer Navigation">
        <a href="../encoding/" class="btn btn-neutral float-left" title="encoding"><span class="icon icon-circle-arrow-left"></span> Previous</a>
        <a href="../metrics/" class="btn btn-neutral float-right" title="metrics">Next <span class="icon icon-circle-arrow-right"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
        <span>
          <a href="https://github.com/rasmushaa/metrics-toolbox" class="fa fa-code-fork" style="color: #fcfcfc"> rasmushaa/metrics-toolbox</a>
        </span>
    
    
      <span><a href="../encoding/" style="color: #fcfcfc">&laquo; Previous</a></span>
    
    
      <span><a href="../metrics/" style="color: #fcfcfc">Next &raquo;</a></span>
    
  </span>
</div>
    <script src="../../../js/jquery-3.6.0.min.js"></script>
    <script>var base_url = "../../..";</script>
    <script src="../../../js/theme_extra.js"></script>
    <script src="../../../js/theme.js"></script>
      <script src="../../../search/main.js"></script>
    <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>

</body>
</html>
